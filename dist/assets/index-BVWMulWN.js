(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))o(n);new MutationObserver(n=>{for(const i of n)if(i.type==="childList")for(const d of i.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&o(d)}).observe(document,{childList:!0,subtree:!0});function t(n){const i={};return n.integrity&&(i.integrity=n.integrity),n.referrerPolicy&&(i.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?i.credentials="include":n.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function o(n){if(n.ep)return;n.ep=!0;const i=t(n);fetch(n.href,i)}})();const s={UI_UPDATE_MS:100,CHART_INTERVAL_MS:1e4,CHART_MAX_POINTS:30,STARTING_MONEY:0,MAIL_TOTAL:5,MAIL_TOTAL_UPGRADED:10,MAIL_SYNC_SECONDS:2,AUTO_MAIL_CHECK_DELAY_MS:50,UPGRADE_AUTO_MAIL_COST:100,UPGRADE_INSTANT_SYNC_COST:200,UPGRADE_FASTER_AUTO_MAIL_COST:150,UPGRADE_DOUBLE_MAILBOX_BASE_COST:200,UPGRADE_INCREASE_MAILBOX_COST:1e3,UPGRADES_MODULE_THRESHOLD:200,PROGRESS_MODULE_THRESHOLD:1500,COUNTER_MODULE_THRESHOLD:20199999e3,UPGRADE_AUTO_MAIL_THRESHOLD:200,UPGRADE_INSTANT_SYNC_THRESHOLD:500,UPGRADE_FASTER_AUTO_MAIL_THRESHOLD:1e3,UPGRADE_DOUBLE_MAILBOX_THRESHOLD:2e3,UPGRADE_INCREASE_MAILBOX_THRESHOLD:1e4,ADD_STAKEHOLDER_COST:5e3,UPGRADE_COMM_OFFICER_BASE_COST:500,UPGRADE_DOUBLE_CORPORATION_BASE_COST:1e3,UPGRADE_WORLD_MAIL_BASE_COST:100,UPGRADE_WORLD_CONTACT_BASE_COST:200,DOCUMENT_SIGNATURE_DELAY_MS:200,SCOPE_CREEP_INCREMENT:5,SCOPE_CREEP_MAX:100,MODULE_2_THRESHOLD:2e5,MODULE_3_THRESHOLD:2e6,WIN_THRESHOLD:1e11,MAIL_HANDLED_MULTIPLIER:50,TOTAL_EMAILS_MULTIPLIER:1e6};function c(a){const e=document.getElementById(a);if(!e)throw new Error(`Missing element: #${a}`);return e}function P(a=new Date){return`${a.getHours()}:${a.getMinutes().toString().padStart(2,"0")}`}function k(a,e,t){return Math.max(e,Math.min(t,a))}class v{constructor(){if(this.isDebugMode=!1,this.onDebugToggle=[],this.onMoneyBoost=null,this.debugBtn=document.getElementById("debugBtn"),!this.debugBtn)throw new Error("Missing debug button #debugBtn");this.debugBtn.addEventListener("click",()=>this.toggleDebugMode()),this.updateButtonStyle()}toggleDebugMode(){this.isDebugMode=!this.isDebugMode,this.updateButtonStyle(),this.onDebugToggle.forEach(e=>e(this.isDebugMode)),this.isDebugMode&&this.onMoneyBoost&&this.onMoneyBoost(),console.log(`Debug mode: ${this.isDebugMode?"ON":"OFF"}`),this.isDebugMode&&console.log("💰 Debug money granted!")}updateButtonStyle(){this.isDebugMode?(this.debugBtn.textContent="Debug: ON",this.debugBtn.style.backgroundColor="#4caf50",this.debugBtn.style.color="white",this.debugBtn.style.fontWeight="bold"):(this.debugBtn.textContent="Debug Mode",this.debugBtn.style.backgroundColor="",this.debugBtn.style.color="",this.debugBtn.style.fontWeight="")}isEnabled(){return this.isDebugMode}onToggle(e){this.onDebugToggle.push(e)}onBoostMoney(e){this.onMoneyBoost=e}unlockModule(e){const t=document.getElementById(e);t&&(t.style.display="",console.log(`[DEBUG] Unlocked module: ${e}`))}setOverhead(e){console.log(`[DEBUG] Setting overhead to: ${e}`)}}class H{constructor(e){this.lastTotal=0,this.chart=new Chart(e,{type:"line",data:{labels:[],datasets:[{label:"Delta per interval",data:[],borderColor:"blue",fill:!1}]},options:{animation:!1,responsive:!0,scales:{x:{title:{display:!0,text:"Time (hh:mm)"}},y:{title:{display:!0,text:"Delta"}}}}})}updateDelta(e){const t=e-this.lastTotal;this.lastTotal=e;const o=this.chart.data.labels,n=this.chart.data.datasets[0].data;o.push(P()),n.push(t),o.length>s.CHART_MAX_POINTS&&(o.shift(),n.shift()),this.chart.update()}getLastTotal(){return this.lastTotal}setLastTotal(e){this.lastTotal=e}}class L{constructor(e,t=!0){this.moduleId=e,this.isUnlocked=t}unlock(){if(this.isUnlocked)return;this.isUnlocked=!0;const e=document.getElementById(this.moduleId);e&&(e.classList.remove("locked"),console.log(`Module unlocked: ${this.moduleId}`))}getIsUnlocked(){return this.isUnlocked}}const N=[{subject:"RE: Synergy Update - Q2 Planning",sender:"Alice Smith"},{subject:"Action Items for Next Sprint",sender:"Bob Johnson"},{subject:"RE: Leverage Insights from Last Meeting",sender:"Carol Lee"},{subject:"Quick Sync - Project Status Update",sender:"David Kim"},{subject:"Value Add Opportunities for Team Growth",sender:"Emma Brown"},{subject:"Strategic Alignment for Cross-Functional Initiatives",sender:"Frank Turner"},{subject:"Touch Base: Driving Operational Excellence",sender:"Grace Miller"},{subject:"RE: Optimize Workflow for Enhanced Productivity",sender:"Henry Clark"},{subject:"FYI: Streamlining Stakeholder Engagement",sender:"Ivy Wilson"},{subject:"Next Steps: Empowering Agile Transformation",sender:"Jack Davis"},{subject:"RE: Circle Back on Deliverables",sender:"Karen Young"},{subject:"Proactive Outreach: Client Satisfaction Metrics",sender:"Liam Scott"},{subject:"RE: Driving Results Through Collaboration",sender:"Mia Evans"},{subject:"Quarterly Review: KPIs and Milestones",sender:"Noah Reed"},{subject:"RE: Action Required - Process Optimization",sender:"Olivia Carter"},{subject:"Team Standup: Alignment on Objectives",sender:"Paul Walker"},{subject:"RE: Feedback Loop for Continuous Improvement",sender:"Quinn Adams"},{subject:"Update: Resource Allocation for Upcoming Projects",sender:"Rachel Green"},{subject:"RE: Leveraging Best Practices for Success",sender:"Sam Parker"},{subject:"FYI: Upcoming Town Hall Meeting",sender:"Tina Brooks"},{subject:"RE: Action Plan for Enhanced Engagement",sender:"Uma Patel"},{subject:"Follow-Up: Stakeholder Feedback Summary",sender:"Victor Chen"},{subject:"RE: Driving Innovation Across Teams",sender:"Wendy Lopez"},{subject:"Reminder: Submit Q3 Roadmap Updates",sender:"Xavier King"},{subject:"RE: Streamline Communication Channels",sender:"Yara Simmons"},{subject:"Update: Cross-Team Collaboration Initiatives",sender:"Zane Murphy"},{subject:"RE: Action Items from Leadership Sync",sender:"Abby Foster"},{subject:"FYI: New Onboarding Process Overview",sender:"Ben Harper"},{subject:"RE: Enhancing Customer Experience Metrics",sender:"Cody Bell"},{subject:"Weekly Recap: Progress and Next Steps",sender:"Dana Fox"}];class $ extends L{constructor(){super("mailbox",!0),this.mailHandled=0,this.mailSyncing=!1,this.autoMailPurchased=!1,this.instantSyncPurchased=!1,this.autoMailRunning=!1,this.fasterAutoMailPurchased=!1,this.doubleMailboxCount=0,this.totalOverhead=0,this.increaseMailboxPurchased=!1,this.lastOpmUpdate=Date.now(),this.lastPrimaryValue=0,this.currentOpm=0,this.onMoneyChange=null,this.mailboxContainer=c("mailboxContainer"),this.mailSelectAllActionBtn=c("mailSelectAllActionBtn"),this.mailSelectBtn=c("mailSelectBtn"),this.mailReplyBtn=c("mailReplyBtn"),this.mailSyncBtn=c("mailSyncBtn")}init(){this.renderMailbox(),this.updateMailUI(),this.mailSelectAllActionBtn.addEventListener("click",()=>this.handleSelectAllAction()),this.mailReplyBtn.addEventListener("click",()=>this.handleReplyAll())}update(e){}getMetrics(){const e=s.MAIL_HANDLED_MULTIPLIER*Math.pow(2,this.doubleMailboxCount),t=Date.now(),o=(t-this.lastOpmUpdate)/6e4;if(o>=.1){const n=this.totalOverhead-this.lastPrimaryValue;this.currentOpm=n/o,this.lastOpmUpdate=t,this.lastPrimaryValue=this.totalOverhead}return{name:"Mailbox",primaryValue:this.totalOverhead,label:`Mails handled: ${this.mailHandled}`,opm:this.currentOpm,multiplier:e}}getMailCheckboxes(){return this.mailboxContainer.querySelectorAll(".mail-checkbox")}updateMailUI(){const e=this.getMailCheckboxes(),t=Array.from(e).filter(i=>i.checked).length,n=(this.increaseMailboxPurchased?s.MAIL_TOTAL_UPGRADED:s.MAIL_TOTAL)-t;this.mailSyncing?(this.mailSelectAllActionBtn.style.display="none",this.mailSelectBtn.style.display="none",this.mailReplyBtn.style.display="none",this.mailSyncBtn.style.display="block"):n===0?(this.mailSelectAllActionBtn.style.display="none",this.mailSelectBtn.style.display="none",this.mailReplyBtn.style.display="block",this.mailSyncBtn.style.display="none"):(this.mailSelectBtn.textContent=`Select ${n}...`,this.mailSelectBtn.disabled=!0,this.mailSelectBtn.style.display="block",this.mailSelectAllActionBtn.style.display="none",this.mailReplyBtn.style.display="none",this.mailSyncBtn.style.display="none")}handleMailCheckboxChange(){this.updateMailUI()}handleSelectAllAction(){this.getMailCheckboxes().forEach(t=>t.checked=!0),this.updateMailUI()}handleReplyAll(){this.mailHandled+=1;const e=s.MAIL_HANDLED_MULTIPLIER*Math.pow(2,this.doubleMailboxCount);this.totalOverhead+=e;const t=Math.floor(e/Math.log10(this.totalOverhead+10));if(this.onMoneyChange&&t>0&&this.onMoneyChange(t),this.instantSyncPurchased){this.resetMailbox();return}this.mailSyncing=!0,this.mailboxContainer.querySelectorAll(".mail-item").forEach(d=>d.style.display="none");let n=s.MAIL_SYNC_SECONDS;this.mailSyncBtn.textContent=`Outlook synchronizing. ${n}...`,this.mailSyncBtn.style.display="block",this.mailReplyBtn.style.display="none",this.mailSelectBtn.style.display="none";const i=setInterval(()=>{n--,this.mailSyncBtn.textContent=`Outlook synchronizing. ${n}...`,n<=0&&(clearInterval(i),this.resetMailbox())},1e3)}resetMailbox(){this.mailSyncing=!1,this.renderMailbox(),this.updateMailUI(),this.autoMailPurchased&&!this.autoMailRunning&&setTimeout(()=>this.autoCheckMails(),500)}async autoCheckMails(){if(this.mailSyncing||this.autoMailRunning)return;this.autoMailRunning=!0;const e=this.getMailCheckboxes(),t=this.fasterAutoMailPurchased?s.AUTO_MAIL_CHECK_DELAY_MS/2:s.AUTO_MAIL_CHECK_DELAY_MS;for(let o=0;o<e.length;o++)await new Promise(n=>setTimeout(n,t)),e[o].checked=!0,this.updateMailUI();await new Promise(o=>setTimeout(o,t)),this.autoMailRunning=!1,this.handleReplyAll()}getRandomMails(e){return[...N].sort(()=>Math.random()-.5).slice(0,e)}renderMailbox(){this.mailboxContainer.innerHTML="";const e=this.increaseMailboxPurchased?s.MAIL_TOTAL_UPGRADED:s.MAIL_TOTAL;this.getRandomMails(e).forEach(o=>{const n=document.createElement("div");n.className="mail-item";const i=document.createElement("label"),d=document.createElement("input");d.type="checkbox",d.className="mail-checkbox",d.addEventListener("change",()=>this.handleMailCheckboxChange());const m=document.createElement("span");m.className="mail-subject",m.textContent=o.subject;const h=document.createElement("span");h.className="mail-person",h.textContent=o.sender,i.appendChild(d),i.appendChild(m),i.appendChild(h),n.appendChild(i),this.mailboxContainer.appendChild(n)})}purchaseAutoMail(e){return e>=s.UPGRADE_AUTO_MAIL_COST&&!this.autoMailPurchased?(this.autoMailPurchased=!0,this.onMoneyChange&&this.onMoneyChange(-100),!this.mailSyncing&&!this.autoMailRunning&&this.autoCheckMails(),!0):!1}purchaseInstantSync(e){return e>=s.UPGRADE_INSTANT_SYNC_COST&&!this.instantSyncPurchased?(this.instantSyncPurchased=!0,this.onMoneyChange&&this.onMoneyChange(-200),!0):!1}purchaseFasterAutoMail(e){return e>=s.UPGRADE_FASTER_AUTO_MAIL_COST&&!this.fasterAutoMailPurchased?(this.fasterAutoMailPurchased=!0,this.onMoneyChange&&this.onMoneyChange(-150),!0):!1}purchaseDoubleMailbox(e){const t=s.UPGRADE_DOUBLE_MAILBOX_BASE_COST*Math.pow(2,this.doubleMailboxCount);return e>=t?(this.doubleMailboxCount++,this.onMoneyChange&&this.onMoneyChange(-t),!0):!1}purchaseIncreaseMailbox(e){return e>=s.UPGRADE_INCREASE_MAILBOX_COST&&!this.increaseMailboxPurchased?(this.increaseMailboxPurchased=!0,this.onMoneyChange&&this.onMoneyChange(-1e3),this.renderMailbox(),this.updateMailUI(),!0):!1}getMailHandled(){return this.mailHandled}isAutoMailPurchased(){return this.autoMailPurchased}isInstantSyncPurchased(){return this.instantSyncPurchased}isFasterAutoMailPurchased(){return this.fasterAutoMailPurchased}getDoubleMailboxCount(){return this.doubleMailboxCount}getDoubleMailboxCost(){return s.UPGRADE_DOUBLE_MAILBOX_BASE_COST*Math.pow(2,this.doubleMailboxCount)}isIncreaseMailboxPurchased(){return this.increaseMailboxPurchased}setOnMoneyChange(e){this.onMoneyChange=e}addOverhead(e){this.totalOverhead+=e}}const x=[{title:"Best Practices Framework for Best Practices"},{title:"Strategic Synergy Optimization Protocol"},{title:"Cross-Functional Value Alignment Matrix"},{title:"Agile Transformation Enablement Guidelines"},{title:"Holistic Stakeholder Engagement Framework"},{title:"Enterprise-Wide Scalability Roadmap"},{title:"Dynamic Resource Allocation Methodology"},{title:"Operational Excellence Acceleration Plan"},{title:"Unified Governance and Compliance Charter"},{title:"Innovation-Driven Growth Strategy Document"}],w=["CEO","CFO","CTO","Legal","HR","Marketing","Sales","External Auditor","Board Member","Compliance Officer","Regional Manager","Department Head","Project Lead"];class W extends L{constructor(){super("overheadManager",!1),this.isStarted=!1,this.currentDocument=null,this.documentInProgress=!1,this.documentsCompleted=0,this.permanentStakeholders=["CEO","CFO","Legal"],this.commOfficerCount=0,this.documentSpeedMultiplier=1,this.doubleCorporationCount=3,this.totalOverhead=0,this.lastOpmUpdate=Date.now(),this.lastPrimaryValue=0,this.currentOpm=0,this.onMoneyChange=null,this.documentTitle=c("documentTitle"),this.signatureProgress=c("signatureProgress"),this.documentInfo=c("documentInfo"),this.scopeCreepValue=c("scopeCreepValue"),this.scopeCreepBar=c("scopeCreepBar"),this.hoursWasted=c("hoursWasted"),this.startCorporationBtn=c("startCorporationBtn"),this.documentStatus=c("documentStatus")}init(){this.startCorporationBtn.addEventListener("click",()=>this.startMinigame())}startMinigame(){if(this.isStarted)return;this.isStarted=!0,this.startCorporationBtn.style.display="none",this.documentStatus.style.display="block";const e=document.getElementById("upgradeStakeholderRow"),t=document.getElementById("upgradeDoubleCorporationRow"),o=document.getElementById("upgradeCommOfficerRow");e&&(e.style.display="table-row"),t&&(t.style.display="table-row"),o&&(o.style.display="table-row"),this.currentDocument=this.createNewDocument(),this.documentInProgress=!0,this.updateDocumentUI(),this.processDocument()}update(e){}getMetrics(){const e=Math.pow(2,this.doubleCorporationCount),t=Date.now(),o=(t-this.lastOpmUpdate)/6e4;if(o>=.1){const n=this.totalOverhead-this.lastPrimaryValue;this.currentOpm=n/o,this.lastOpmUpdate=t,this.lastPrimaryValue=this.totalOverhead}return{name:"Corporation",primaryValue:this.totalOverhead,label:`Documents completed: ${this.documentsCompleted}`,opm:this.currentOpm,multiplier:e}}getRandomPolicy(){const e=Math.floor(Math.random()*x.length);return x[e].title}createNewDocument(){return{title:this.getRandomPolicy(),version:"v1.2.3",signatories:[...this.permanentStakeholders],currentSignatureIndex:0,totalRevisions:0,scopeCreep:0}}updateDocumentUI(){if(!this.currentDocument)return;const e=this.currentDocument;this.documentTitle.textContent=`${e.title} ${e.version}`,this.signatureProgress.innerHTML=e.signatories.map((t,o)=>{const n=o<e.currentSignatureIndex,i=o===e.currentSignatureIndex;return`<span style="${n?"color: green;":i?"color: orange;":"color: gray;"}">${n?"●":"○"} ${t}</span>`}).join(" → "),this.documentInfo.textContent=`Signatures: ${e.currentSignatureIndex}/${e.signatories.length} | Revisions: ${e.totalRevisions}`,this.scopeCreepValue.textContent=Math.floor(e.scopeCreep).toString(),this.scopeCreepBar.style.width=`${e.scopeCreep}%`}async processDocument(){if(!this.currentDocument||!this.documentInProgress)return;const e=this.currentDocument,t=s.DOCUMENT_SIGNATURE_DELAY_MS/this.documentSpeedMultiplier;for(;e.currentSignatureIndex<e.signatories.length;)await new Promise(n=>setTimeout(n,t)),e.currentSignatureIndex++,this.updateDocumentUI();e.scopeCreep=Math.min(e.scopeCreep+s.SCOPE_CREEP_INCREMENT,s.SCOPE_CREEP_MAX),e.totalRevisions++,e.currentSignatureIndex=0;const o=e.version.match(/v(\d+)\.(\d+)\.(\d+)/);if(o){const n=parseInt(o[3])+1;e.version=`v${o[1]}.${o[2]}.${n}`}if(this.updateDocumentUI(),e.scopeCreep>=s.SCOPE_CREEP_MAX){const n=e.signatories.length*100,i=Math.pow(2,this.doubleCorporationCount),d=n*i;this.hoursWasted.textContent=`⚠️ ${d} hours wasted! ⚠️`,this.hoursWasted.style.display="block",this.hoursWasted.style.animation="blink 1s infinite",this.totalOverhead+=d;const m=Math.floor(d/Math.log10(this.totalOverhead+10));this.onMoneyChange&&m>0&&this.onMoneyChange(m),this.documentsCompleted++,this.currentDocument=this.createNewDocument(),this.documentInProgress=!0,this.updateDocumentUI(),setTimeout(()=>{this.hoursWasted.style.display="none"},2e3),this.processDocument()}else this.processDocument()}addStakeholder(){if(!this.currentDocument||!this.documentInProgress)return;const e=this.currentDocument,t=w.filter(o=>!this.permanentStakeholders.includes(o));if(t.length>0){const o=t[Math.floor(Math.random()*t.length)];this.permanentStakeholders.push(o),e.signatories.push(o),e.scopeCreep=Math.min(e.scopeCreep+10,s.SCOPE_CREEP_MAX),this.onMoneyChange&&this.onMoneyChange(-5e3),this.updateDocumentUI()}}purchaseStakeholder(e){if(!this.isStarted||!this.currentDocument||!this.documentInProgress)return!1;if(e>=s.ADD_STAKEHOLDER_COST){const t=this.currentDocument,o=w.filter(n=>!this.permanentStakeholders.includes(n));if(o.length>0){const n=o[Math.floor(Math.random()*o.length)];return this.permanentStakeholders.push(n),t.signatories.push(n),t.scopeCreep=Math.min(t.scopeCreep+10,s.SCOPE_CREEP_MAX),this.onMoneyChange&&this.onMoneyChange(-5e3),this.updateDocumentUI(),!0}}return!1}purchaseDoubleCorporation(e){const t=s.UPGRADE_DOUBLE_CORPORATION_BASE_COST*Math.pow(2,this.doubleCorporationCount);return e>=t?(this.doubleCorporationCount++,this.onMoneyChange&&this.onMoneyChange(-t),!0):!1}purchaseCommOfficer(e){const t=s.UPGRADE_COMM_OFFICER_BASE_COST*Math.pow(2,this.commOfficerCount);return e>=t?(this.commOfficerCount++,this.documentSpeedMultiplier*=2,this.onMoneyChange&&this.onMoneyChange(-t),!0):!1}getCommOfficerCost(){return s.UPGRADE_COMM_OFFICER_BASE_COST*Math.pow(2,this.commOfficerCount)}getDoubleCorporationCost(){return s.UPGRADE_DOUBLE_CORPORATION_BASE_COST*Math.pow(2,this.doubleCorporationCount)}getDoubleCorporationCount(){return this.doubleCorporationCount}getCommOfficerCount(){return this.commOfficerCount}getDocumentSpeedMultiplier(){return this.documentSpeedMultiplier}setOnMoneyChange(e){this.onMoneyChange=e}}class G extends L{constructor(){if(super("world",!1),this.isActive=!1,this.mailsPerSecond=0,this.avgContactsPerPerson=1,this.totalEmailsSent=0,this.worldMailCount=0,this.worldContactCount=0,this.lastOpmUpdate=Date.now(),this.lastPrimaryValue=0,this.currentOpm=0,this.onMoneyChange=null,this.animationFrame=null,this.dots=[],this.paths=[],this.lastUpdateTime=0,this.mailsEl=document.getElementById("worldMails"),this.contactsEl=document.getElementById("worldContacts"),this.totalEl=document.getElementById("worldTotal"),this.treeEl=document.getElementById("worldTree"),this.startBtn=document.getElementById("worldBtn"),this.worldContent=document.getElementById("worldContent"),!this.mailsEl||!this.contactsEl||!this.totalEl||!this.treeEl||!this.startBtn||!this.worldContent)throw new Error("Missing world module elements")}init(){this.startBtn.addEventListener("click",()=>this.startModule()),this.updateDisplay()}update(e){}getMetrics(){const e=Math.floor(this.totalEmailsSent*s.TOTAL_EMAILS_MULTIPLIER),t=Date.now(),o=(t-this.lastOpmUpdate)/6e4;if(o>=.1){const n=e-this.lastPrimaryValue;this.currentOpm=n/o,this.lastOpmUpdate=t,this.lastPrimaryValue=e}return{name:"World",primaryValue:e,label:`Total emails sent: ${Math.floor(this.totalEmailsSent).toLocaleString()}`,opm:this.currentOpm,multiplier:s.TOTAL_EMAILS_MULTIPLIER}}startModule(){if(this.isActive)return;this.isActive=!0,this.startBtn.style.display="none",this.worldContent.style.display="block";const e=document.getElementById("upgradeWorldMailRow"),t=document.getElementById("upgradeWorldContactRow");e&&(e.style.display="table-row"),t&&(t.style.display="table-row"),this.animate()}purchaseWorldMail(e){const t=this.getWorldMailCost();return e>=t?(this.worldMailCount++,this.mailsPerSecond++,this.onMoneyChange&&this.onMoneyChange(-t),this.updateDisplay(),!0):!1}purchaseWorldContact(e){const t=this.getWorldContactCost();return e>=t?(this.worldContactCount++,this.avgContactsPerPerson++,this.onMoneyChange&&this.onMoneyChange(-t),this.updateDisplay(),!0):!1}getWorldMailCost(){return s.UPGRADE_WORLD_MAIL_BASE_COST*Math.pow(2,this.worldMailCount)}getWorldContactCost(){return s.UPGRADE_WORLD_CONTACT_BASE_COST*Math.pow(2,this.worldContactCount)}getWorldMailCount(){return this.worldMailCount}getWorldContactCount(){return this.worldContactCount}setOnMoneyChange(e){this.onMoneyChange=e}updateDisplay(){this.mailsEl.textContent=this.mailsPerSecond.toString(),this.contactsEl.textContent=this.avgContactsPerPerson.toString(),this.totalEl.textContent=Math.floor(this.totalEmailsSent).toLocaleString(),this.mailsEl.style.animation="none",this.contactsEl.style.animation="none",this.totalEl.style.animation="none",setTimeout(()=>{this.mailsEl.style.animation="pulse 0.3s ease",this.contactsEl.style.animation="pulse 0.3s ease",this.totalEl.style.animation="pulse 0.3s ease"},10),this.renderTree()}renderTree(){const e=this.treeEl.offsetWidth||400,t=250;let o=this.treeEl.querySelector("svg");o||(o=document.createElementNS("http://www.w3.org/2000/svg","svg"),o.style.width="100%",o.style.height="250px",o.style.display="block",this.treeEl.appendChild(o)),o.setAttribute("viewBox",`0 0 ${e} ${t}`),o.setAttribute("preserveAspectRatio","xMidYMid meet");const n=Array.from(o.querySelectorAll(".mail-dot"));o.innerHTML="",n.forEach(h=>o.appendChild(h)),this.paths=[];const i=e/2,d=30,m=Math.max(this.avgContactsPerPerson,1);this.drawBranch(o,i,d,0,m,e,t)}drawBranch(e,t,o,n,i,d,m){const h=document.createElementNS("http://www.w3.org/2000/svg","circle");if(h.setAttribute("cx",t.toString()),h.setAttribute("cy",o.toString()),h.setAttribute("r",n===0?"6":"4"),h.setAttribute("fill",`hsl(${n*80}, 70%, 60%)`),h.setAttribute("data-depth",n.toString()),e.appendChild(h),n>=2)return;const g=o+100,u=n===0?10:3,p=Math.min(i,u),f=Math.max(0,i-u),A=Math.min(d/(p+1),80);for(let M=0;M<p;M++){const B=(M-(p-1)/2)*A,b=t+B,R=Math.max(20,Math.min(d-20,b)),O=document.createElementNS("http://www.w3.org/2000/svg","line");O.setAttribute("x1",t.toString()),O.setAttribute("y1",o.toString()),O.setAttribute("x2",R.toString()),O.setAttribute("y2",g.toString()),O.setAttribute("stroke","#4ecdc4"),O.setAttribute("stroke-opacity","0.6"),O.setAttribute("stroke-width","1"),e.appendChild(O),this.paths.push({x1:t,y1:o,x2:R,y2:g,depth:n}),this.drawBranch(e,R,g,n+1,i,d,m)}if(f>0){const M=t+(p-1)/2*A,B=Math.min(M+30,d-40),b=document.createElementNS("http://www.w3.org/2000/svg","text");b.setAttribute("x",B.toString()),b.setAttribute("y",(g+4).toString()),b.setAttribute("text-anchor","middle"),b.setAttribute("fill","#ff9800"),b.setAttribute("font-size","11"),b.setAttribute("font-weight","bold"),b.textContent=`+${f}`,e.appendChild(b)}}animate(){if(!this.isActive)return;const e=performance.now(),t=this.lastUpdateTime?(e-this.lastUpdateTime)/1e3:0;this.lastUpdateTime=e;const o=Math.max(this.avgContactsPerPerson,1),n=o+o*o;t>0&&t<1&&(this.totalEmailsSent+=this.mailsPerSecond*n*t,this.totalEl.textContent=Math.floor(this.totalEmailsSent).toLocaleString());const i=.008,m=Math.min(.1+this.mailsPerSecond*.1,5)*.015;this.paths.length>0&&Math.random()<m&&this.paths.map((u,p)=>({path:u,idx:p})).filter(({path:u})=>u.depth===0).forEach(({idx:u})=>{this.dots.push({progress:0,pathIndex:u,hasSpawnedChildren:!1})});const h=[];this.dots=this.dots.filter(g=>{if(g.progress+=i,g.progress>=.5&&!g.hasSpawnedChildren){g.hasSpawnedChildren=!0;const u=this.paths[g.pathIndex];u&&this.paths.forEach((p,f)=>{const A=Math.abs(p.x1-u.x2),M=Math.abs(p.y1-u.y2);A<5&&M<5&&f!==g.pathIndex&&h.push({progress:0,pathIndex:f,hasSpawnedChildren:!1})})}return g.progress<1}),this.dots.push(...h);const _=this.treeEl.querySelector("svg");_&&(_.querySelectorAll(".mail-dot").forEach(u=>u.remove()),this.dots.forEach(u=>{if(u.pathIndex<this.paths.length){const p=this.paths[u.pathIndex],f=p.x1+(p.x2-p.x1)*u.progress,A=p.y1+(p.y2-p.y1)*u.progress,M=document.createElementNS("http://www.w3.org/2000/svg","circle");M.classList.add("mail-dot"),M.setAttribute("cx",f.toString()),M.setAttribute("cy",A.toString()),M.setAttribute("r","3"),M.setAttribute("fill","#ff6b6b"),_.appendChild(M)}})),this.animationFrame=requestAnimationFrame(()=>this.animate())}isRunning(){return this.isActive}getTotalEmailsSent(){return this.totalEmailsSent}}class F{constructor(){this.state={counters:[],outputValue:0,money:s.STARTING_MONEY,lastChartTotal:0,stepMultiplier:1,mailHandled:0,mailSyncing:!1,autoMailPurchased:!1,autoMailRunning:!1,instantSyncPurchased:!1,selectAllPurchased:!1,currentDocument:null,documentInProgress:!1,documentsCompleted:0,permanentStakeholders:["CEO","CFO","Legal"],commOfficerCount:0,documentSpeedMultiplier:1,hoursWastedTotal:0,module2Unlocked:!1,module3Unlocked:!1,winModuleShown:!1}}getMoney(){return this.state.money}getOutputValue(){return this.state.outputValue}getStepMultiplier(){return this.state.stepMultiplier}getCounters(){return this.state.counters}isModule2Unlocked(){return this.state.module2Unlocked}isModule3Unlocked(){return this.state.module3Unlocked}isWinModuleShown(){return this.state.winModuleShown}setOutputValue(e){this.state.outputValue=e}addMoney(e){this.state.money+=e}spendMoney(e){return this.state.money>=e?(this.state.money-=e,!0):!1}setModule2Unlocked(e){this.state.module2Unlocked=e}setModule3Unlocked(e){this.state.module3Unlocked=e}setWinModuleShown(e){this.state.winModuleShown=e}addCounter(e){this.state.counters.push(e)}doubleStepMultiplier(){this.state.stepMultiplier*=2}}const l=new F,r={totalEl:c("total"),progressBar:c("progressBar"),progressText:c("progressText"),upgradeAutoMailBtn:c("upgradeAutoMailBtn"),upgradeFasterAutoMailBtn:c("upgradeFasterAutoMailBtn"),upgradeInstantSyncBtn:c("upgradeInstantSyncBtn"),upgradeIncreaseMailboxBtn:c("upgradeIncreaseMailboxBtn"),upgradeDoubleMailboxBtn:c("upgradeDoubleMailboxBtn"),upgradeStakeholderBtn:c("upgradeStakeholderBtn"),upgradeDoubleCorporationBtn:c("upgradeDoubleCorporationBtn"),upgradeCommOfficerBtn:c("upgradeCommOfficerBtn"),upgradeWorldMailBtn:c("upgradeWorldMailBtn"),upgradeWorldContactBtn:c("upgradeWorldContactBtn"),ctx:c("counterChart"),moduleStatsBody:c("moduleStatsBody")},y=new $,C=new W,S=new G,j=new H(r.ctx),I=new v;function V(a){if(!l.isModule2Unlocked()&&a>=s.MODULE_2_THRESHOLD&&(l.setModule2Unlocked(!0),C.unlock()),!l.isModule3Unlocked()&&a>=s.MODULE_3_THRESHOLD&&(l.setModule3Unlocked(!0),S.unlock()),!l.isWinModuleShown()&&a>=s.WIN_THRESHOLD){l.setWinModuleShown(!0);const e=document.getElementById("module-win");if(e){e.classList.remove("locked"),console.log("You win!");const t=document.getElementById("mailbox"),o=document.getElementById("overheadManager"),n=document.getElementById("world"),i=document.getElementById("counterModule"),d=document.getElementById("upgrades"),m=document.getElementById("progressModule"),h=document.querySelector(".top-bar");t&&(t.style.display="none"),o&&(o.style.display="none"),n&&(n.style.display="none"),i&&(i.style.display="none"),d&&(d.style.display="none"),m&&(m.style.display="none"),h&&(h.style.display="none")}}}function Y(a){let e=0,t="";if(a<s.MODULE_2_THRESHOLD)e=a/s.MODULE_2_THRESHOLD*100,t=`Level 1: ${Math.floor(a).toLocaleString()} / 200k`;else if(a<s.MODULE_3_THRESHOLD){const o=s.MODULE_3_THRESHOLD-s.MODULE_2_THRESHOLD;e=(a-s.MODULE_2_THRESHOLD)/o*100,t=`Level 2: ${Math.floor(a).toLocaleString()} / 2M`}else{const o=s.WIN_THRESHOLD-s.MODULE_3_THRESHOLD;e=(a-s.MODULE_3_THRESHOLD)/o*100,t=`Level 3: ${Math.floor(a).toLocaleString()} / 100B`}e=k(e,0,100),r.progressBar.style.width=e+"%",r.progressText.textContent=`${e.toFixed(2)}% - ${t}`}function X(){const a=y.getMetrics(),e=C.getMetrics(),t=S.getMetrics();return a.primaryValue+e.primaryValue+t.primaryValue}function K(){const a=y.getMetrics(),e=C.getMetrics(),t=S.getMetrics(),o=[a,e,t];r.moduleStatsBody.innerHTML=o.map(n=>{const i=n.opm!==void 0?Math.floor(n.opm).toLocaleString():"0",d=n.multiplier!==void 0?`${n.multiplier}x`:"1x",m=Math.floor(n.primaryValue).toLocaleString();return`
      <tr style="border-bottom: 1px solid #444;">
        <td style="padding: 8px;">${n.name}</td>
        <td style="text-align: right; padding: 8px;">${m}</td>
        <td style="text-align: right; padding: 8px;">${i}</td>
        <td style="text-align: right; padding: 8px;">${d}</td>
      </tr>
    `}).join("")}function E(){const a=X();if(l.setOutputValue(a),r.totalEl.textContent=`Total overhead: ${Math.floor(a)}h | Money: $${Math.floor(l.getMoney())}`,Y(a),K(),ae(a),V(a),!l.isWinModuleShown()){const f=document.getElementById("upgrades"),A=document.getElementById("progressModule"),M=document.getElementById("counterModule");f&&a>=s.UPGRADES_MODULE_THRESHOLD&&(f.style.display=""),A&&a>=s.PROGRESS_MODULE_THRESHOLD&&(A.style.display=""),M&&a>=s.COUNTER_MODULE_THRESHOLD&&(M.style.display="")}const e=document.getElementById("upgradeAutoMailRow"),t=document.getElementById("upgradeFasterAutoMailRow"),o=document.getElementById("upgradeInstantSyncRow"),n=document.getElementById("upgradeDoubleMailboxRow"),i=document.getElementById("upgradeIncreaseMailboxRow");e&&(e.style.display=a>=s.UPGRADE_AUTO_MAIL_THRESHOLD?"":"none"),t&&(t.style.display=a>=s.UPGRADE_FASTER_AUTO_MAIL_THRESHOLD?"":"none"),o&&(o.style.display=a>=s.UPGRADE_INSTANT_SYNC_THRESHOLD?"":"none"),n&&(n.style.display=a>=s.UPGRADE_DOUBLE_MAILBOX_THRESHOLD?"":"none"),i&&(i.style.display=a>=s.UPGRADE_INCREASE_MAILBOX_THRESHOLD?"":"none"),y.isAutoMailPurchased()?(r.upgradeAutoMailBtn.textContent="Intern: Active",r.upgradeAutoMailBtn.disabled=!0):(r.upgradeAutoMailBtn.textContent=`Intern ad ($${s.UPGRADE_AUTO_MAIL_COST})`,r.upgradeAutoMailBtn.disabled=l.getMoney()<s.UPGRADE_AUTO_MAIL_COST),y.isFasterAutoMailPurchased()?(r.upgradeFasterAutoMailBtn.textContent="No breaks: Active",r.upgradeFasterAutoMailBtn.disabled=!0):(r.upgradeFasterAutoMailBtn.textContent=`No breaks for intern ($${s.UPGRADE_FASTER_AUTO_MAIL_COST})`,r.upgradeFasterAutoMailBtn.disabled=l.getMoney()<s.UPGRADE_FASTER_AUTO_MAIL_COST),y.isInstantSyncPurchased()?(r.upgradeInstantSyncBtn.textContent="Instant Sync: Active",r.upgradeInstantSyncBtn.disabled=!0):(r.upgradeInstantSyncBtn.textContent=`Instant Sync ($${s.UPGRADE_INSTANT_SYNC_COST})`,r.upgradeInstantSyncBtn.disabled=l.getMoney()<s.UPGRADE_INSTANT_SYNC_COST),y.isIncreaseMailboxPurchased()?(r.upgradeIncreaseMailboxBtn.textContent="Mailbox Size: 10 Emails",r.upgradeIncreaseMailboxBtn.disabled=!0):(r.upgradeIncreaseMailboxBtn.textContent=`Increase Mailbox to 10 Emails ($${s.UPGRADE_INCREASE_MAILBOX_COST})`,r.upgradeIncreaseMailboxBtn.disabled=l.getMoney()<s.UPGRADE_INCREASE_MAILBOX_COST);const d=y.getDoubleMailboxCost(),m=y.getDoubleMailboxCount();r.upgradeDoubleMailboxBtn.textContent=`Double Mailbox Output ($${d}) [${m}x]`,r.upgradeDoubleMailboxBtn.disabled=l.getMoney()<d,r.upgradeStakeholderBtn.textContent=`Add Stakeholder ($${s.ADD_STAKEHOLDER_COST})`,r.upgradeStakeholderBtn.disabled=l.getMoney()<s.ADD_STAKEHOLDER_COST;const h=C.getDoubleCorporationCost(),_=C.getDoubleCorporationCount();r.upgradeDoubleCorporationBtn.textContent=`Double Corporation Output ($${h}) [${_}x]`,r.upgradeDoubleCorporationBtn.disabled=l.getMoney()<h;const g=C.getCommOfficerCost();r.upgradeCommOfficerBtn.textContent=`Hire Comm Officer ($${g}) [${C.getCommOfficerCount()}x, ${C.getDocumentSpeedMultiplier()}x speed]`,r.upgradeCommOfficerBtn.disabled=l.getMoney()<g;const u=S.getWorldMailCost(),p=S.getWorldContactCost();return r.upgradeWorldMailBtn.textContent=`+1 Mail/sec ($${u.toLocaleString()}) [${S.getWorldMailCount()}]`,r.upgradeWorldMailBtn.disabled=l.getMoney()<u,r.upgradeWorldContactBtn.textContent=`+1 Contact/person ($${p.toLocaleString()}) [${S.getWorldContactCount()}]`,r.upgradeWorldContactBtn.disabled=l.getMoney()<p,a}function q(){y.purchaseAutoMail(l.getMoney())?E():alert("Not enough money!")}function z(){y.purchaseFasterAutoMail(l.getMoney())?E():alert("Not enough money!")}function Q(){y.purchaseInstantSync(l.getMoney())?E():alert("Not enough money!")}function J(){y.purchaseIncreaseMailbox(l.getMoney())?E():alert("Not enough money!")}function Z(){y.purchaseDoubleMailbox(l.getMoney())?E():alert("Not enough money!")}function ee(){C.purchaseStakeholder(l.getMoney())?E():alert("Not enough money!")}function te(){C.purchaseDoubleCorporation(l.getMoney())?E():alert("Not enough money!")}function oe(){C.purchaseCommOfficer(l.getMoney())?E():alert("Not enough money!")}function ne(){S.purchaseWorldMail(l.getMoney())?E():alert("Not enough money!")}function se(){S.purchaseWorldContact(l.getMoney())?E():alert("Not enough money!")}I.onBoostMoney(()=>{l.addMoney(9999999999999),E()});I.onToggle(a=>{if(a){console.log("Debug commands available:"),console.log("- Click Module 2 header to unlock Corporation"),console.log("- Click Module 3 header to unlock World");const e=document.querySelector("#overheadManager h4");e&&e.addEventListener("click",()=>{I.unlockModule("overheadManager"),l.setModule2Unlocked(!0),C.unlock()});const t=document.querySelector("#world h4");t&&t.addEventListener("click",()=>{I.unlockModule("world"),l.setModule3Unlocked(!0),S.unlock()})}});const U=document.getElementById("addOverheadBtn");U&&U.addEventListener("click",()=>{y.addOverhead(2e10),E()});r.upgradeAutoMailBtn.addEventListener("click",q);r.upgradeFasterAutoMailBtn.addEventListener("click",z);r.upgradeInstantSyncBtn.addEventListener("click",Q);r.upgradeIncreaseMailboxBtn.addEventListener("click",J);r.upgradeDoubleMailboxBtn.addEventListener("click",Z);r.upgradeStakeholderBtn.addEventListener("click",ee);r.upgradeDoubleCorporationBtn.addEventListener("click",te);r.upgradeCommOfficerBtn.addEventListener("click",oe);r.upgradeWorldMailBtn.addEventListener("click",ne);r.upgradeWorldContactBtn.addEventListener("click",se);y.setOnMoneyChange(a=>l.addMoney(a));C.setOnMoneyChange(a=>l.addMoney(a));S.setOnMoneyChange(a=>l.addMoney(a));const D=[{threshold:0,message:"A new day at the office!"},{threshold:200,message:"Your coworkers praise your dedication!"},{threshold:500,message:"The IT department installs a new mail server to handle growing demand."},{threshold:1200,message:"Overtime has been approved for your department."},{threshold:2e3,message:"HR is recruiting project managers for your department."},{threshold:5e3,message:"HR is hiring middle management to ease your workload."},{threshold:1e4,message:"The IT department invests in email supercomputers."},{threshold:5e4,message:"People are sleeping at the office to keep up with the emails."},{threshold:1e5,message:"You’re getting noticed by the suits on the top floor."},{threshold:2e5,message:"CONGRATULATIONS! You’ve been promoted!"},{threshold:5e5,message:"The CFO enjoyed the latest project kickoff in Dubai."},{threshold:7e5,message:"A lifetime of wasted hours."},{threshold:2e6,message:"Your hard work is recognized by the United Nations."},{threshold:1e7,message:"AI data centers are being repurposed as mail servers."},{threshold:1e8,message:"Researchers establish a direct neural link between emails and the frontal lobe."},{threshold:9e10,message:"The system is overwhelmed..."}];let T=-1;function ae(a){const e=document.getElementById("currentMessage"),t=document.getElementById("previousMessage");if(!e||!t)return;let o=-1;for(let n=D.length-1;n>=0;n--)if(a>=D[n].threshold){o=n;break}if(o!==T&&o>=0){const n=T>=0?D[T].message:"",i=D[o].message;t.textContent=n,e.textContent=i,T=o}}function ie(){y.init(),C.init(),S.init(),setInterval(E,s.UI_UPDATE_MS),setInterval(()=>{const a=E();j.updateDelta(a)},s.CHART_INTERVAL_MS),console.log("Reply All - The Game started!"),console.log("Modules loaded: Mailbox, Corporation (locked), World (locked)")}ie();
