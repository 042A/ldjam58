(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))n(o);new MutationObserver(o=>{for(const a of o)if(a.type==="childList")for(const u of a.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&n(u)}).observe(document,{childList:!0,subtree:!0});function e(o){const a={};return o.integrity&&(a.integrity=o.integrity),o.referrerPolicy&&(a.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?a.credentials="include":o.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function n(o){if(o.ep)return;o.ep=!0;const a=e(o);fetch(o.href,a)}})();const s={UI_UPDATE_MS:100,CHART_INTERVAL_MS:1e4,CHART_MAX_POINTS:30,STARTING_MONEY:1e4,MAIL_TOTAL:5,MAIL_TOTAL_UPGRADED:10,MAIL_SYNC_SECONDS:2,AUTO_MAIL_CHECK_DELAY_MS:50,UPGRADE_AUTO_MAIL_COST:1e3,UPGRADE_INSTANT_SYNC_COST:2e3,UPGRADE_FASTER_AUTO_MAIL_COST:1500,UPGRADE_DOUBLE_MAILBOX_BASE_COST:500,UPGRADE_INCREASE_MAILBOX_COST:1e3,UPGRADE_AUTO_MAIL_THRESHOLD:200,UPGRADE_INSTANT_SYNC_THRESHOLD:500,UPGRADE_FASTER_AUTO_MAIL_THRESHOLD:1e3,UPGRADE_DOUBLE_MAILBOX_THRESHOLD:2e3,UPGRADE_INCREASE_MAILBOX_THRESHOLD:1e4,ADD_STAKEHOLDER_COST:5e3,UPGRADE_COMM_OFFICER_BASE_COST:500,UPGRADE_DOUBLE_CORPORATION_BASE_COST:1e3,DOCUMENT_SIGNATURE_DELAY_MS:200,SCOPE_CREEP_INCREMENT:5,SCOPE_CREEP_MAX:100,MODULE_2_THRESHOLD:2e5,MODULE_3_THRESHOLD:2e6,WIN_THRESHOLD:1e13,MAIL_HANDLED_MULTIPLIER:50,TOTAL_EMAILS_MULTIPLIER:1e6};function c(i){const t=document.getElementById(i);if(!t)throw new Error(`Missing element: #${i}`);return t}function P(i=new Date){return`${i.getHours()}:${i.getMinutes().toString().padStart(2,"0")}`}function U(i,t,e){return Math.max(t,Math.min(e,i))}class w{constructor(){if(this.isDebugMode=!1,this.onDebugToggle=[],this.onMoneyBoost=null,this.debugBtn=document.getElementById("debugBtn"),!this.debugBtn)throw new Error("Missing debug button #debugBtn");this.debugBtn.addEventListener("click",()=>this.toggleDebugMode()),this.updateButtonStyle()}toggleDebugMode(){this.isDebugMode=!this.isDebugMode,this.updateButtonStyle(),this.onDebugToggle.forEach(t=>t(this.isDebugMode)),this.isDebugMode&&this.onMoneyBoost&&this.onMoneyBoost(),console.log(`Debug mode: ${this.isDebugMode?"ON":"OFF"}`),this.isDebugMode&&console.log("💰 Debug money granted!")}updateButtonStyle(){this.isDebugMode?(this.debugBtn.textContent="Debug: ON",this.debugBtn.style.backgroundColor="#4caf50",this.debugBtn.style.color="white",this.debugBtn.style.fontWeight="bold"):(this.debugBtn.textContent="Debug Mode",this.debugBtn.style.backgroundColor="",this.debugBtn.style.color="",this.debugBtn.style.fontWeight="")}isEnabled(){return this.isDebugMode}onToggle(t){this.onDebugToggle.push(t)}onBoostMoney(t){this.onMoneyBoost=t}unlockModule(t){const e=document.getElementById(t);e&&(e.style.display="",console.log(`[DEBUG] Unlocked module: ${t}`))}setOverhead(t){console.log(`[DEBUG] Setting overhead to: ${t}`)}}class k{constructor(t){this.lastTotal=0,this.chart=new Chart(t,{type:"line",data:{labels:[],datasets:[{label:"Delta per interval",data:[],borderColor:"blue",fill:!1}]},options:{animation:!1,responsive:!0,scales:{x:{title:{display:!0,text:"Time (hh:mm)"}},y:{title:{display:!0,text:"Delta"}}}}})}updateDelta(t){const e=t-this.lastTotal;this.lastTotal=t;const n=this.chart.data.labels,o=this.chart.data.datasets[0].data;n.push(P()),o.push(e),n.length>s.CHART_MAX_POINTS&&(n.shift(),o.shift()),this.chart.update()}getLastTotal(){return this.lastTotal}setLastTotal(t){this.lastTotal=t}}class T{constructor(t,e=!0){this.moduleId=t,this.isUnlocked=e}unlock(){if(this.isUnlocked)return;this.isUnlocked=!0;const t=document.getElementById(this.moduleId);t&&(t.classList.remove("locked"),console.log(`Module unlocked: ${this.moduleId}`))}getIsUnlocked(){return this.isUnlocked}}const v=[{subject:"RE: Synergy Update - Q2 Planning",sender:"Alice Smith"},{subject:"Action Items for Next Sprint",sender:"Bob Johnson"},{subject:"RE: Leverage Insights from Last Meeting",sender:"Carol Lee"},{subject:"Quick Sync - Project Status Update",sender:"David Kim"},{subject:"Value Add Opportunities for Team Growth",sender:"Emma Brown"},{subject:"Strategic Alignment for Cross-Functional Initiatives",sender:"Frank Turner"},{subject:"Touch Base: Driving Operational Excellence",sender:"Grace Miller"},{subject:"RE: Optimize Workflow for Enhanced Productivity",sender:"Henry Clark"},{subject:"FYI: Streamlining Stakeholder Engagement",sender:"Ivy Wilson"},{subject:"Next Steps: Empowering Agile Transformation",sender:"Jack Davis"}];class H extends T{constructor(){super("mailbox",!0),this.mailHandled=0,this.mailSyncing=!1,this.autoMailPurchased=!1,this.instantSyncPurchased=!1,this.autoMailRunning=!1,this.fasterAutoMailPurchased=!1,this.doubleMailboxCount=0,this.totalOverhead=0,this.increaseMailboxPurchased=!1,this.lastOpmUpdate=Date.now(),this.lastPrimaryValue=0,this.currentOpm=0,this.onMoneyChange=null,this.mailboxContainer=c("mailboxContainer"),this.mailSelectAllActionBtn=c("mailSelectAllActionBtn"),this.mailSelectBtn=c("mailSelectBtn"),this.mailReplyBtn=c("mailReplyBtn"),this.mailSyncBtn=c("mailSyncBtn")}init(){this.renderMailbox(),this.updateMailUI(),this.mailSelectAllActionBtn.addEventListener("click",()=>this.handleSelectAllAction()),this.mailReplyBtn.addEventListener("click",()=>this.handleReplyAll())}update(t){}getMetrics(){const t=s.MAIL_HANDLED_MULTIPLIER*Math.pow(2,this.doubleMailboxCount),e=Date.now(),n=(e-this.lastOpmUpdate)/6e4;if(n>=.1){const o=this.totalOverhead-this.lastPrimaryValue;this.currentOpm=o/n,this.lastOpmUpdate=e,this.lastPrimaryValue=this.totalOverhead}return{name:"Mailbox",primaryValue:this.totalOverhead,label:`Mails handled: ${this.mailHandled}`,opm:this.currentOpm,multiplier:t}}getMailCheckboxes(){return this.mailboxContainer.querySelectorAll(".mail-checkbox")}updateMailUI(){const t=this.getMailCheckboxes(),e=Array.from(t).filter(a=>a.checked).length,o=(this.increaseMailboxPurchased?s.MAIL_TOTAL_UPGRADED:s.MAIL_TOTAL)-e;this.mailSyncing?(this.mailSelectAllActionBtn.style.display="none",this.mailSelectBtn.style.display="none",this.mailReplyBtn.style.display="none",this.mailSyncBtn.style.display="block"):o===0?(this.mailSelectAllActionBtn.style.display="none",this.mailSelectBtn.style.display="none",this.mailReplyBtn.style.display="block",this.mailSyncBtn.style.display="none"):(this.mailSelectBtn.textContent=`Select ${o}...`,this.mailSelectBtn.disabled=!0,this.mailSelectBtn.style.display="block",this.mailSelectAllActionBtn.style.display="none",this.mailReplyBtn.style.display="none",this.mailSyncBtn.style.display="none")}handleMailCheckboxChange(){this.updateMailUI()}handleSelectAllAction(){this.getMailCheckboxes().forEach(e=>e.checked=!0),this.updateMailUI()}handleReplyAll(){this.mailHandled+=1;const t=s.MAIL_HANDLED_MULTIPLIER*Math.pow(2,this.doubleMailboxCount);if(this.totalOverhead+=t,this.instantSyncPurchased){this.resetMailbox();return}this.mailSyncing=!0,this.mailboxContainer.querySelectorAll(".mail-item").forEach(a=>a.style.display="none");let n=s.MAIL_SYNC_SECONDS;this.mailSyncBtn.textContent=`Outlook synchronizing. ${n}...`,this.mailSyncBtn.style.display="block",this.mailReplyBtn.style.display="none",this.mailSelectBtn.style.display="none";const o=setInterval(()=>{n--,this.mailSyncBtn.textContent=`Outlook synchronizing. ${n}...`,n<=0&&(clearInterval(o),this.resetMailbox())},1e3)}resetMailbox(){this.mailSyncing=!1,this.renderMailbox(),this.updateMailUI(),this.autoMailPurchased&&!this.autoMailRunning&&setTimeout(()=>this.autoCheckMails(),500)}async autoCheckMails(){if(this.mailSyncing||this.autoMailRunning)return;this.autoMailRunning=!0;const t=this.getMailCheckboxes(),e=this.fasterAutoMailPurchased?s.AUTO_MAIL_CHECK_DELAY_MS/2:s.AUTO_MAIL_CHECK_DELAY_MS;for(let n=0;n<t.length;n++)await new Promise(o=>setTimeout(o,e)),t[n].checked=!0,this.updateMailUI();await new Promise(n=>setTimeout(n,e)),this.autoMailRunning=!1,this.handleReplyAll()}getRandomMails(t){return[...v].sort(()=>Math.random()-.5).slice(0,t)}renderMailbox(){this.mailboxContainer.innerHTML="";const t=this.increaseMailboxPurchased?s.MAIL_TOTAL_UPGRADED:s.MAIL_TOTAL;this.getRandomMails(t).forEach(n=>{const o=document.createElement("div");o.className="mail-item";const a=document.createElement("label"),u=document.createElement("input");u.type="checkbox",u.className="mail-checkbox",u.addEventListener("change",()=>this.handleMailCheckboxChange());const p=document.createElement("span");p.className="mail-subject",p.textContent=n.subject;const h=document.createElement("span");h.className="mail-person",h.textContent=n.sender,a.appendChild(u),a.appendChild(p),a.appendChild(h),o.appendChild(a),this.mailboxContainer.appendChild(o)})}purchaseAutoMail(t){return t>=s.UPGRADE_AUTO_MAIL_COST&&!this.autoMailPurchased?(this.autoMailPurchased=!0,this.onMoneyChange&&this.onMoneyChange(-1e3),!this.mailSyncing&&!this.autoMailRunning&&this.autoCheckMails(),!0):!1}purchaseInstantSync(t){return t>=s.UPGRADE_INSTANT_SYNC_COST&&!this.instantSyncPurchased?(this.instantSyncPurchased=!0,this.onMoneyChange&&this.onMoneyChange(-2e3),!0):!1}purchaseFasterAutoMail(t){return t>=s.UPGRADE_FASTER_AUTO_MAIL_COST&&!this.fasterAutoMailPurchased?(this.fasterAutoMailPurchased=!0,this.onMoneyChange&&this.onMoneyChange(-1500),!0):!1}purchaseDoubleMailbox(t){const e=s.UPGRADE_DOUBLE_MAILBOX_BASE_COST*Math.pow(2,this.doubleMailboxCount);return t>=e?(this.doubleMailboxCount++,this.onMoneyChange&&this.onMoneyChange(-e),!0):!1}purchaseIncreaseMailbox(t){return t>=s.UPGRADE_INCREASE_MAILBOX_COST&&!this.increaseMailboxPurchased?(this.increaseMailboxPurchased=!0,this.onMoneyChange&&this.onMoneyChange(-1e3),this.renderMailbox(),this.updateMailUI(),!0):!1}getMailHandled(){return this.mailHandled}isAutoMailPurchased(){return this.autoMailPurchased}isInstantSyncPurchased(){return this.instantSyncPurchased}isFasterAutoMailPurchased(){return this.fasterAutoMailPurchased}getDoubleMailboxCount(){return this.doubleMailboxCount}getDoubleMailboxCost(){return s.UPGRADE_DOUBLE_MAILBOX_BASE_COST*Math.pow(2,this.doubleMailboxCount)}isIncreaseMailboxPurchased(){return this.increaseMailboxPurchased}setOnMoneyChange(t){this.onMoneyChange=t}addOverhead(t){this.totalOverhead+=t}}const x=[{title:"Best Practices Framework for Best Practices"},{title:"Strategic Synergy Optimization Protocol"},{title:"Cross-Functional Value Alignment Matrix"},{title:"Agile Transformation Enablement Guidelines"},{title:"Holistic Stakeholder Engagement Framework"},{title:"Enterprise-Wide Scalability Roadmap"},{title:"Dynamic Resource Allocation Methodology"},{title:"Operational Excellence Acceleration Plan"},{title:"Unified Governance and Compliance Charter"},{title:"Innovation-Driven Growth Strategy Document"}],L=["CEO","CFO","CTO","Legal","HR","Marketing","Sales","External Auditor","Board Member","Compliance Officer","Regional Manager","Department Head","Project Lead"];class N extends T{constructor(){super("overheadManager",!1),this.isStarted=!1,this.currentDocument=null,this.documentInProgress=!1,this.documentsCompleted=0,this.permanentStakeholders=["CEO","CFO","Legal"],this.commOfficerCount=0,this.documentSpeedMultiplier=1,this.doubleCorporationCount=3,this.totalOverhead=0,this.lastOpmUpdate=Date.now(),this.lastPrimaryValue=0,this.currentOpm=0,this.onMoneyChange=null,this.documentTitle=c("documentTitle"),this.signatureProgress=c("signatureProgress"),this.documentInfo=c("documentInfo"),this.scopeCreepValue=c("scopeCreepValue"),this.scopeCreepBar=c("scopeCreepBar"),this.hoursWasted=c("hoursWasted"),this.startCorporationBtn=c("startCorporationBtn"),this.documentStatus=c("documentStatus")}init(){this.startCorporationBtn.addEventListener("click",()=>this.startMinigame())}startMinigame(){if(this.isStarted)return;this.isStarted=!0,this.startCorporationBtn.style.display="none",this.documentStatus.style.display="block";const t=document.getElementById("upgradeStakeholderRow"),e=document.getElementById("upgradeDoubleCorporationRow"),n=document.getElementById("upgradeCommOfficerRow");t&&(t.style.display="table-row"),e&&(e.style.display="table-row"),n&&(n.style.display="table-row"),this.currentDocument=this.createNewDocument(),this.documentInProgress=!0,this.updateDocumentUI(),this.processDocument()}update(t){}getMetrics(){const t=Math.pow(2,this.doubleCorporationCount),e=Date.now(),n=(e-this.lastOpmUpdate)/6e4;if(n>=.1){const o=this.totalOverhead-this.lastPrimaryValue;this.currentOpm=o/n,this.lastOpmUpdate=e,this.lastPrimaryValue=this.totalOverhead}return{name:"Corporation",primaryValue:this.totalOverhead,label:`Documents completed: ${this.documentsCompleted}`,opm:this.currentOpm,multiplier:t}}getRandomPolicy(){const t=Math.floor(Math.random()*x.length);return x[t].title}createNewDocument(){return{title:this.getRandomPolicy(),version:"v1.2.3",signatories:[...this.permanentStakeholders],currentSignatureIndex:0,totalRevisions:0,scopeCreep:0}}updateDocumentUI(){if(!this.currentDocument)return;const t=this.currentDocument;this.documentTitle.textContent=`${t.title} ${t.version}`,this.signatureProgress.innerHTML=t.signatories.map((e,n)=>{const o=n<t.currentSignatureIndex,a=n===t.currentSignatureIndex;return`<span style="${o?"color: green;":a?"color: orange;":"color: gray;"}">${o?"●":"○"} ${e}</span>`}).join(" → "),this.documentInfo.textContent=`Signatures: ${t.currentSignatureIndex}/${t.signatories.length} | Revisions: ${t.totalRevisions}`,this.scopeCreepValue.textContent=Math.floor(t.scopeCreep).toString(),this.scopeCreepBar.style.width=`${t.scopeCreep}%`}async processDocument(){if(!this.currentDocument||!this.documentInProgress)return;const t=this.currentDocument,e=s.DOCUMENT_SIGNATURE_DELAY_MS/this.documentSpeedMultiplier;for(;t.currentSignatureIndex<t.signatories.length;)await new Promise(o=>setTimeout(o,e)),t.currentSignatureIndex++,this.updateDocumentUI();t.scopeCreep=Math.min(t.scopeCreep+s.SCOPE_CREEP_INCREMENT,s.SCOPE_CREEP_MAX),t.totalRevisions++,t.currentSignatureIndex=0;const n=t.version.match(/v(\d+)\.(\d+)\.(\d+)/);if(n){const o=parseInt(n[3])+1;t.version=`v${n[1]}.${n[2]}.${o}`}if(this.updateDocumentUI(),t.scopeCreep>=s.SCOPE_CREEP_MAX){const o=t.signatories.length*100,a=Math.pow(2,this.doubleCorporationCount),u=o*a;this.hoursWasted.textContent=`⚠️ ${u} hours wasted! ⚠️`,this.hoursWasted.style.display="block",this.hoursWasted.style.animation="blink 1s infinite",this.onMoneyChange&&this.onMoneyChange(1e3),this.documentsCompleted++,this.totalOverhead+=u,this.currentDocument=this.createNewDocument(),this.documentInProgress=!0,this.updateDocumentUI(),setTimeout(()=>{this.hoursWasted.style.display="none"},2e3),this.processDocument()}else this.processDocument()}addStakeholder(){if(!this.currentDocument||!this.documentInProgress)return;const t=this.currentDocument,e=L.filter(n=>!this.permanentStakeholders.includes(n));if(e.length>0){const n=e[Math.floor(Math.random()*e.length)];this.permanentStakeholders.push(n),t.signatories.push(n),t.scopeCreep=Math.min(t.scopeCreep+10,s.SCOPE_CREEP_MAX),this.onMoneyChange&&this.onMoneyChange(-5e3),this.updateDocumentUI()}}purchaseStakeholder(t){if(!this.isStarted||!this.currentDocument||!this.documentInProgress)return!1;if(t>=s.ADD_STAKEHOLDER_COST){const e=this.currentDocument,n=L.filter(o=>!this.permanentStakeholders.includes(o));if(n.length>0){const o=n[Math.floor(Math.random()*n.length)];return this.permanentStakeholders.push(o),e.signatories.push(o),e.scopeCreep=Math.min(e.scopeCreep+10,s.SCOPE_CREEP_MAX),this.onMoneyChange&&this.onMoneyChange(-5e3),this.updateDocumentUI(),!0}}return!1}purchaseDoubleCorporation(t){const e=s.UPGRADE_DOUBLE_CORPORATION_BASE_COST*Math.pow(2,this.doubleCorporationCount);return t>=e?(this.doubleCorporationCount++,this.onMoneyChange&&this.onMoneyChange(-e),!0):!1}purchaseCommOfficer(t){const e=s.UPGRADE_COMM_OFFICER_BASE_COST*Math.pow(2,this.commOfficerCount);return t>=e?(this.commOfficerCount++,this.documentSpeedMultiplier*=2,this.onMoneyChange&&this.onMoneyChange(-e),!0):!1}getCommOfficerCost(){return s.UPGRADE_COMM_OFFICER_BASE_COST*Math.pow(2,this.commOfficerCount)}getDoubleCorporationCost(){return s.UPGRADE_DOUBLE_CORPORATION_BASE_COST*Math.pow(2,this.doubleCorporationCount)}getDoubleCorporationCount(){return this.doubleCorporationCount}getCommOfficerCount(){return this.commOfficerCount}getDocumentSpeedMultiplier(){return this.documentSpeedMultiplier}setOnMoneyChange(t){this.onMoneyChange=t}}class $ extends T{constructor(){if(super("world",!1),this.isActive=!1,this.mailsPerSecond=0,this.avgContactsPerPerson=1,this.totalEmailsSent=0,this.lastOpmUpdate=Date.now(),this.lastPrimaryValue=0,this.currentOpm=0,this.animationFrame=null,this.dots=[],this.paths=[],this.lastUpdateTime=0,this.mailsEl=document.getElementById("worldMails"),this.contactsEl=document.getElementById("worldContacts"),this.totalEl=document.getElementById("worldTotal"),this.treeEl=document.getElementById("worldTree"),this.startBtn=document.getElementById("worldBtn"),this.worldContent=document.getElementById("worldContent"),!this.mailsEl||!this.contactsEl||!this.totalEl||!this.treeEl||!this.startBtn||!this.worldContent)throw new Error("Missing world module elements")}init(){this.startBtn.addEventListener("click",()=>this.startModule()),this.updateDisplay()}update(t){}getMetrics(){const t=Math.floor(this.totalEmailsSent*s.TOTAL_EMAILS_MULTIPLIER),e=Date.now(),n=(e-this.lastOpmUpdate)/6e4;if(n>=.1){const o=t-this.lastPrimaryValue;this.currentOpm=o/n,this.lastOpmUpdate=e,this.lastPrimaryValue=t}return{name:"World",primaryValue:t,label:`Total emails sent: ${Math.floor(this.totalEmailsSent).toLocaleString()}`,opm:this.currentOpm,multiplier:s.TOTAL_EMAILS_MULTIPLIER}}startModule(){if(this.isActive)return;this.isActive=!0,this.startBtn.style.display="none",this.worldContent.style.display="block";const t=document.getElementById("upgradeWorldMailRow"),e=document.getElementById("upgradeWorldContactRow");t&&(t.style.display="table-row"),e&&(e.style.display="table-row"),this.animate()}addMail(){this.mailsPerSecond++,this.updateDisplay()}addContact(){this.avgContactsPerPerson++,this.updateDisplay()}updateDisplay(){this.mailsEl.textContent=this.mailsPerSecond.toString(),this.contactsEl.textContent=this.avgContactsPerPerson.toString(),this.totalEl.textContent=Math.floor(this.totalEmailsSent).toLocaleString(),this.mailsEl.style.animation="none",this.contactsEl.style.animation="none",this.totalEl.style.animation="none",setTimeout(()=>{this.mailsEl.style.animation="pulse 0.3s ease",this.contactsEl.style.animation="pulse 0.3s ease",this.totalEl.style.animation="pulse 0.3s ease"},10),this.renderTree()}renderTree(){const t=this.treeEl.offsetWidth||400,e=250;let n=this.treeEl.querySelector("svg");n||(n=document.createElementNS("http://www.w3.org/2000/svg","svg"),n.style.width="100%",n.style.height="250px",n.style.display="block",this.treeEl.appendChild(n)),n.setAttribute("viewBox",`0 0 ${t} ${e}`),n.setAttribute("preserveAspectRatio","xMidYMid meet");const o=Array.from(n.querySelectorAll(".mail-dot"));n.innerHTML="",o.forEach(h=>n.appendChild(h)),this.paths=[];const a=t/2,u=30,p=Math.max(this.avgContactsPerPerson,1);this.drawBranch(n,a,u,0,p,t,e)}drawBranch(t,e,n,o,a,u,p){const h=document.createElementNS("http://www.w3.org/2000/svg","circle");if(h.setAttribute("cx",e.toString()),h.setAttribute("cy",n.toString()),h.setAttribute("r",o===0?"6":"4"),h.setAttribute("fill",`hsl(${o*80}, 70%, 60%)`),h.setAttribute("data-depth",o.toString()),t.appendChild(h),o>=2)return;const m=n+100,d=o===0?10:3,g=Math.min(a,d),A=Math.max(0,a-d),_=Math.min(u/(g+1),80);for(let y=0;y<g;y++){const I=(y-(g-1)/2)*_,f=e+I,B=Math.max(20,Math.min(u-20,f)),E=document.createElementNS("http://www.w3.org/2000/svg","line");E.setAttribute("x1",e.toString()),E.setAttribute("y1",n.toString()),E.setAttribute("x2",B.toString()),E.setAttribute("y2",m.toString()),E.setAttribute("stroke","#4ecdc4"),E.setAttribute("stroke-opacity","0.6"),E.setAttribute("stroke-width","1"),t.appendChild(E),this.paths.push({x1:e,y1:n,x2:B,y2:m,depth:o}),this.drawBranch(t,B,m,o+1,a,u,p)}if(A>0){const y=e+(g-1)/2*_,I=Math.min(y+30,u-40),f=document.createElementNS("http://www.w3.org/2000/svg","text");f.setAttribute("x",I.toString()),f.setAttribute("y",(m+4).toString()),f.setAttribute("text-anchor","middle"),f.setAttribute("fill","#ff9800"),f.setAttribute("font-size","11"),f.setAttribute("font-weight","bold"),f.textContent=`+${A}`,t.appendChild(f)}}animate(){if(!this.isActive)return;const t=performance.now(),e=this.lastUpdateTime?(t-this.lastUpdateTime)/1e3:0;this.lastUpdateTime=t;const n=Math.max(this.avgContactsPerPerson,1),o=n+n*n;e>0&&e<1&&(this.totalEmailsSent+=this.mailsPerSecond*o*e,this.totalEl.textContent=Math.floor(this.totalEmailsSent).toLocaleString());const a=.008,p=Math.min(.1+this.mailsPerSecond*.1,5)*.015;this.paths.length>0&&Math.random()<p&&this.paths.map((d,g)=>({path:d,idx:g})).filter(({path:d})=>d.depth===0).forEach(({idx:d})=>{this.dots.push({progress:0,pathIndex:d,hasSpawnedChildren:!1})});const h=[];this.dots=this.dots.filter(m=>{if(m.progress+=a,m.progress>=.5&&!m.hasSpawnedChildren){m.hasSpawnedChildren=!0;const d=this.paths[m.pathIndex];d&&this.paths.forEach((g,A)=>{const _=Math.abs(g.x1-d.x2),y=Math.abs(g.y1-d.y2);_<5&&y<5&&A!==m.pathIndex&&h.push({progress:0,pathIndex:A,hasSpawnedChildren:!1})})}return m.progress<1}),this.dots.push(...h);const O=this.treeEl.querySelector("svg");O&&(O.querySelectorAll(".mail-dot").forEach(d=>d.remove()),this.dots.forEach(d=>{if(d.pathIndex<this.paths.length){const g=this.paths[d.pathIndex],A=g.x1+(g.x2-g.x1)*d.progress,_=g.y1+(g.y2-g.y1)*d.progress,y=document.createElementNS("http://www.w3.org/2000/svg","circle");y.classList.add("mail-dot"),y.setAttribute("cx",A.toString()),y.setAttribute("cy",_.toString()),y.setAttribute("r","3"),y.setAttribute("fill","#ff6b6b"),O.appendChild(y)}})),this.animationFrame=requestAnimationFrame(()=>this.animate())}isRunning(){return this.isActive}getTotalEmailsSent(){return this.totalEmailsSent}}class G{constructor(){this.state={counters:[],outputValue:0,money:s.STARTING_MONEY,lastChartTotal:0,stepMultiplier:1,mailHandled:0,mailSyncing:!1,autoMailPurchased:!1,autoMailRunning:!1,instantSyncPurchased:!1,selectAllPurchased:!1,currentDocument:null,documentInProgress:!1,documentsCompleted:0,permanentStakeholders:["CEO","CFO","Legal"],commOfficerCount:0,documentSpeedMultiplier:1,hoursWastedTotal:0,module2Unlocked:!1,module3Unlocked:!1,winModuleShown:!1}}getMoney(){return this.state.money}getOutputValue(){return this.state.outputValue}getStepMultiplier(){return this.state.stepMultiplier}getCounters(){return this.state.counters}isModule2Unlocked(){return this.state.module2Unlocked}isModule3Unlocked(){return this.state.module3Unlocked}isWinModuleShown(){return this.state.winModuleShown}setOutputValue(t){this.state.outputValue=t}addMoney(t){this.state.money+=t}spendMoney(t){return this.state.money>=t?(this.state.money-=t,!0):!1}setModule2Unlocked(t){this.state.module2Unlocked=t}setModule3Unlocked(t){this.state.module3Unlocked=t}setWinModuleShown(t){this.state.winModuleShown=t}addCounter(t){this.state.counters.push(t)}doubleStepMultiplier(){this.state.stepMultiplier*=2}}const l=new G,r={totalEl:c("total"),progressBar:c("progressBar"),progressText:c("progressText"),upgradeAutoMailBtn:c("upgradeAutoMailBtn"),upgradeFasterAutoMailBtn:c("upgradeFasterAutoMailBtn"),upgradeInstantSyncBtn:c("upgradeInstantSyncBtn"),upgradeIncreaseMailboxBtn:c("upgradeIncreaseMailboxBtn"),upgradeDoubleMailboxBtn:c("upgradeDoubleMailboxBtn"),upgradeStakeholderBtn:c("upgradeStakeholderBtn"),upgradeDoubleCorporationBtn:c("upgradeDoubleCorporationBtn"),upgradeCommOfficerBtn:c("upgradeCommOfficerBtn"),upgradeWorldMailBtn:c("upgradeWorldMailBtn"),upgradeWorldContactBtn:c("upgradeWorldContactBtn"),ctx:c("counterChart"),moduleStatsBody:c("moduleStatsBody")},M=new H,C=new N,b=new $,F=new k(r.ctx),D=new w;function W(i){if(!l.isModule2Unlocked()&&i>=s.MODULE_2_THRESHOLD&&(l.setModule2Unlocked(!0),C.unlock()),!l.isModule3Unlocked()&&i>=s.MODULE_3_THRESHOLD&&(l.setModule3Unlocked(!0),b.unlock()),!l.isWinModuleShown()&&i>=s.WIN_THRESHOLD){l.setWinModuleShown(!0);const t=document.getElementById("module-win");if(t){t.classList.remove("locked"),console.log("You win!");const e=document.getElementById("mailbox"),n=document.getElementById("overheadManager"),o=document.getElementById("world"),a=document.getElementById("counterModule"),u=document.getElementById("upgrades"),p=document.getElementById("progressModule");e&&(e.style.display="none"),n&&(n.style.display="none"),o&&(o.style.display="none"),a&&(a.style.display="none"),u&&(u.style.display="none"),p&&(p.style.display="none")}}}function V(i){let t=0,e="";if(i<s.MODULE_2_THRESHOLD)t=i/s.MODULE_2_THRESHOLD*100,e=`Level 1: ${Math.floor(i).toLocaleString()} / 200k`;else if(i<s.MODULE_3_THRESHOLD){const n=s.MODULE_3_THRESHOLD-s.MODULE_2_THRESHOLD;t=(i-s.MODULE_2_THRESHOLD)/n*100,e=`Level 2: ${Math.floor(i).toLocaleString()} / 2M`}else{const n=s.WIN_THRESHOLD-s.MODULE_3_THRESHOLD;t=(i-s.MODULE_3_THRESHOLD)/n*100,e=`Level 3: ${Math.floor(i).toLocaleString()} / 10T`}t=U(t,0,100),r.progressBar.style.width=t+"%",r.progressText.textContent=`${t.toFixed(2)}% - ${e}`}function X(){const i=M.getMetrics(),t=C.getMetrics(),e=b.getMetrics();return i.primaryValue+t.primaryValue+e.primaryValue}function Y(){const i=M.getMetrics(),t=C.getMetrics(),e=b.getMetrics(),n=[i,t,e];r.moduleStatsBody.innerHTML=n.map(o=>{const a=o.opm!==void 0?Math.floor(o.opm).toLocaleString():"0",u=o.multiplier!==void 0?`${o.multiplier}x`:"1x",p=Math.floor(o.primaryValue).toLocaleString();return`
      <tr style="border-bottom: 1px solid #444;">
        <td style="padding: 8px;">${o.name}</td>
        <td style="text-align: right; padding: 8px;">${p}</td>
        <td style="text-align: right; padding: 8px;">${a}</td>
        <td style="text-align: right; padding: 8px;">${u}</td>
      </tr>
    `}).join("")}function S(){const i=X();l.setOutputValue(i),r.totalEl.textContent=`Overhead: ${Math.floor(i)}h | Your budget: $${Math.floor(l.getMoney())}`,V(i),Y(),W(i);const t=document.getElementById("upgradeAutoMailRow"),e=document.getElementById("upgradeFasterAutoMailRow"),n=document.getElementById("upgradeInstantSyncRow"),o=document.getElementById("upgradeDoubleMailboxRow"),a=document.getElementById("upgradeIncreaseMailboxRow");t&&(t.style.display=i>=s.UPGRADE_AUTO_MAIL_THRESHOLD?"":"none"),e&&(e.style.display=i>=s.UPGRADE_FASTER_AUTO_MAIL_THRESHOLD?"":"none"),n&&(n.style.display=i>=s.UPGRADE_INSTANT_SYNC_THRESHOLD?"":"none"),o&&(o.style.display=i>=s.UPGRADE_DOUBLE_MAILBOX_THRESHOLD?"":"none"),a&&(a.style.display=i>=s.UPGRADE_INCREASE_MAILBOX_THRESHOLD?"":"none"),M.isAutoMailPurchased()?(r.upgradeAutoMailBtn.textContent="Auto-Mail: Active",r.upgradeAutoMailBtn.disabled=!0):(r.upgradeAutoMailBtn.textContent=`Auto-Mail System ($${s.UPGRADE_AUTO_MAIL_COST})`,r.upgradeAutoMailBtn.disabled=l.getMoney()<s.UPGRADE_AUTO_MAIL_COST),M.isFasterAutoMailPurchased()?(r.upgradeFasterAutoMailBtn.textContent="Faster Auto-Mail: Active",r.upgradeFasterAutoMailBtn.disabled=!0):(r.upgradeFasterAutoMailBtn.textContent=`Faster Auto-Mail ($${s.UPGRADE_FASTER_AUTO_MAIL_COST})`,r.upgradeFasterAutoMailBtn.disabled=l.getMoney()<s.UPGRADE_FASTER_AUTO_MAIL_COST),M.isInstantSyncPurchased()?(r.upgradeInstantSyncBtn.textContent="Instant Sync: Active",r.upgradeInstantSyncBtn.disabled=!0):(r.upgradeInstantSyncBtn.textContent=`Instant Sync ($${s.UPGRADE_INSTANT_SYNC_COST})`,r.upgradeInstantSyncBtn.disabled=l.getMoney()<s.UPGRADE_INSTANT_SYNC_COST),M.isIncreaseMailboxPurchased()?(r.upgradeIncreaseMailboxBtn.textContent="Mailbox Size: 10 Emails",r.upgradeIncreaseMailboxBtn.disabled=!0):(r.upgradeIncreaseMailboxBtn.textContent=`Increase Mailbox to 10 Emails ($${s.UPGRADE_INCREASE_MAILBOX_COST})`,r.upgradeIncreaseMailboxBtn.disabled=l.getMoney()<s.UPGRADE_INCREASE_MAILBOX_COST);const u=M.getDoubleMailboxCost(),p=M.getDoubleMailboxCount();r.upgradeDoubleMailboxBtn.textContent=`Double Mailbox Output ($${u}) [${p}x]`,r.upgradeDoubleMailboxBtn.disabled=l.getMoney()<u,r.upgradeStakeholderBtn.textContent=`Add Stakeholder ($${s.ADD_STAKEHOLDER_COST})`,r.upgradeStakeholderBtn.disabled=l.getMoney()<s.ADD_STAKEHOLDER_COST;const h=C.getDoubleCorporationCost(),O=C.getDoubleCorporationCount();r.upgradeDoubleCorporationBtn.textContent=`Double Corporation Output ($${h}) [${O}x]`,r.upgradeDoubleCorporationBtn.disabled=l.getMoney()<h;const m=C.getCommOfficerCost();return r.upgradeCommOfficerBtn.textContent=`Hire Comm Officer ($${m}) [${C.getCommOfficerCount()}x, ${C.getDocumentSpeedMultiplier()}x speed]`,r.upgradeCommOfficerBtn.disabled=l.getMoney()<m,r.upgradeWorldMailBtn.textContent="+1 Mail/sec",r.upgradeWorldContactBtn.textContent="+1 Contact/person",i}function j(){M.purchaseAutoMail(l.getMoney())?S():alert("Not enough money!")}function q(){M.purchaseFasterAutoMail(l.getMoney())?S():alert("Not enough money!")}function K(){M.purchaseInstantSync(l.getMoney())?S():alert("Not enough money!")}function z(){M.purchaseIncreaseMailbox(l.getMoney())?S():alert("Not enough money!")}function J(){M.purchaseDoubleMailbox(l.getMoney())?S():alert("Not enough money!")}function Q(){C.purchaseStakeholder(l.getMoney())?S():alert("Not enough money!")}function Z(){C.purchaseDoubleCorporation(l.getMoney())?S():alert("Not enough money!")}function tt(){C.purchaseCommOfficer(l.getMoney())?S():alert("Not enough money!")}function et(){b.addMail(),S()}function nt(){b.addContact(),S()}D.onBoostMoney(()=>{l.addMoney(9999999999999),S()});D.onToggle(i=>{if(i){console.log("Debug commands available:"),console.log("- Click Module 2 header to unlock Corporation"),console.log("- Click Module 3 header to unlock World");const t=document.querySelector("#overheadManager h4");t&&t.addEventListener("click",()=>{D.unlockModule("overheadManager"),l.setModule2Unlocked(!0),C.unlock()});const e=document.querySelector("#world h4");e&&e.addEventListener("click",()=>{D.unlockModule("world"),l.setModule3Unlocked(!0),b.unlock()})}});const R=document.getElementById("addOverheadBtn");R&&R.addEventListener("click",()=>{M.addOverhead(2e5),S()});r.upgradeAutoMailBtn.addEventListener("click",j);r.upgradeFasterAutoMailBtn.addEventListener("click",q);r.upgradeInstantSyncBtn.addEventListener("click",K);r.upgradeIncreaseMailboxBtn.addEventListener("click",z);r.upgradeDoubleMailboxBtn.addEventListener("click",J);r.upgradeStakeholderBtn.addEventListener("click",Q);r.upgradeDoubleCorporationBtn.addEventListener("click",Z);r.upgradeCommOfficerBtn.addEventListener("click",tt);r.upgradeWorldMailBtn.addEventListener("click",et);r.upgradeWorldContactBtn.addEventListener("click",nt);M.setOnMoneyChange(i=>l.addMoney(i));C.setOnMoneyChange(i=>l.addMoney(i));function ot(){M.init(),C.init(),b.init(),setInterval(S,s.UI_UPDATE_MS),setInterval(()=>{const i=S();F.updateDelta(i)},s.CHART_INTERVAL_MS),console.log("Reply All - The Game started!"),console.log("Modules loaded: Mailbox, Corporation (locked), World (locked)")}ot();
