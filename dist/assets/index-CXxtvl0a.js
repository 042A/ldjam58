(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))o(n);new MutationObserver(n=>{for(const r of n)if(r.type==="childList")for(const u of r.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&o(u)}).observe(document,{childList:!0,subtree:!0});function e(n){const r={};return n.integrity&&(r.integrity=n.integrity),n.referrerPolicy&&(r.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?r.credentials="include":n.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function o(n){if(n.ep)return;n.ep=!0;const r=e(n);fetch(n.href,r)}})();const s={UI_UPDATE_MS:100,CHART_INTERVAL_MS:1e4,CHART_MAX_POINTS:30,STARTING_MONEY:0,MAIL_TOTAL:5,MAIL_TOTAL_UPGRADED:10,MAIL_SYNC_SECONDS:2,AUTO_MAIL_CHECK_DELAY_MS:50,UPGRADE_AUTO_MAIL_COST:100,UPGRADE_INSTANT_SYNC_COST:200,UPGRADE_FASTER_AUTO_MAIL_COST:150,UPGRADE_DOUBLE_MAILBOX_BASE_COST:200,UPGRADE_INCREASE_MAILBOX_COST:1e3,UPGRADES_MODULE_THRESHOLD:200,PROGRESS_MODULE_THRESHOLD:1500,COUNTER_MODULE_THRESHOLD:201e3,UPGRADE_AUTO_MAIL_THRESHOLD:200,UPGRADE_INSTANT_SYNC_THRESHOLD:500,UPGRADE_FASTER_AUTO_MAIL_THRESHOLD:1e3,UPGRADE_DOUBLE_MAILBOX_THRESHOLD:2e3,UPGRADE_INCREASE_MAILBOX_THRESHOLD:1e4,ADD_STAKEHOLDER_COST:5e3,UPGRADE_COMM_OFFICER_BASE_COST:500,UPGRADE_DOUBLE_CORPORATION_BASE_COST:1e3,UPGRADE_WORLD_MAIL_BASE_COST:100,UPGRADE_WORLD_CONTACT_BASE_COST:200,DOCUMENT_SIGNATURE_DELAY_MS:200,SCOPE_CREEP_INCREMENT:5,SCOPE_CREEP_MAX:100,MODULE_2_THRESHOLD:2e5,MODULE_3_THRESHOLD:2e6,WIN_THRESHOLD:1e11,MAIL_HANDLED_MULTIPLIER:50,TOTAL_EMAILS_MULTIPLIER:1e6};function c(i){const t=document.getElementById(i);if(!t)throw new Error(`Missing element: #${i}`);return t}function U(i=new Date){return`${i.getHours()}:${i.getMinutes().toString().padStart(2,"0")}`}function P(i,t,e){return Math.max(t,Math.min(e,i))}class w{constructor(){if(this.isDebugMode=!1,this.onDebugToggle=[],this.onMoneyBoost=null,this.debugBtn=document.getElementById("debugBtn"),!this.debugBtn)throw new Error("Missing debug button #debugBtn");this.debugBtn.addEventListener("click",()=>this.toggleDebugMode()),this.updateButtonStyle()}toggleDebugMode(){this.isDebugMode=!this.isDebugMode,this.updateButtonStyle(),this.onDebugToggle.forEach(t=>t(this.isDebugMode)),this.isDebugMode&&this.onMoneyBoost&&this.onMoneyBoost(),console.log(`Debug mode: ${this.isDebugMode?"ON":"OFF"}`),this.isDebugMode&&console.log("üí∞ Debug money granted!")}updateButtonStyle(){this.isDebugMode?(this.debugBtn.textContent="Debug: ON",this.debugBtn.style.backgroundColor="#4caf50",this.debugBtn.style.color="white",this.debugBtn.style.fontWeight="bold"):(this.debugBtn.textContent="Debug Mode",this.debugBtn.style.backgroundColor="",this.debugBtn.style.color="",this.debugBtn.style.fontWeight="")}isEnabled(){return this.isDebugMode}onToggle(t){this.onDebugToggle.push(t)}onBoostMoney(t){this.onMoneyBoost=t}unlockModule(t){const e=document.getElementById(t);e&&(e.style.display="",console.log(`[DEBUG] Unlocked module: ${t}`))}setOverhead(t){console.log(`[DEBUG] Setting overhead to: ${t}`)}}class k{constructor(t){this.lastTotal=0,this.chart=new Chart(t,{type:"line",data:{labels:[],datasets:[{label:"Delta per interval",data:[],borderColor:"blue",fill:!1}]},options:{animation:!1,responsive:!0,scales:{x:{title:{display:!0,text:"Time (hh:mm)"}},y:{title:{display:!0,text:"Delta"}}}}})}updateDelta(t){const e=t-this.lastTotal;this.lastTotal=t;const o=this.chart.data.labels,n=this.chart.data.datasets[0].data;o.push(U()),n.push(e),o.length>s.CHART_MAX_POINTS&&(o.shift(),n.shift()),this.chart.update()}getLastTotal(){return this.lastTotal}setLastTotal(t){this.lastTotal=t}}class I{constructor(t,e=!0){this.moduleId=t,this.isUnlocked=e}unlock(){if(this.isUnlocked)return;this.isUnlocked=!0;const t=document.getElementById(this.moduleId);t&&(t.classList.remove("locked"),console.log(`Module unlocked: ${this.moduleId}`))}getIsUnlocked(){return this.isUnlocked}}const v=[{subject:"RE: Synergy Update - Q2 Planning",sender:"Alice Smith"},{subject:"Action Items for Next Sprint",sender:"Bob Johnson"},{subject:"RE: Leverage Insights from Last Meeting",sender:"Carol Lee"},{subject:"Quick Sync - Project Status Update",sender:"David Kim"},{subject:"Value Add Opportunities for Team Growth",sender:"Emma Brown"},{subject:"Strategic Alignment for Cross-Functional Initiatives",sender:"Frank Turner"},{subject:"Touch Base: Driving Operational Excellence",sender:"Grace Miller"},{subject:"RE: Optimize Workflow for Enhanced Productivity",sender:"Henry Clark"},{subject:"FYI: Streamlining Stakeholder Engagement",sender:"Ivy Wilson"},{subject:"Next Steps: Empowering Agile Transformation",sender:"Jack Davis"}];class H extends I{constructor(){super("mailbox",!0),this.mailHandled=0,this.mailSyncing=!1,this.autoMailPurchased=!1,this.instantSyncPurchased=!1,this.autoMailRunning=!1,this.fasterAutoMailPurchased=!1,this.doubleMailboxCount=0,this.totalOverhead=0,this.increaseMailboxPurchased=!1,this.lastOpmUpdate=Date.now(),this.lastPrimaryValue=0,this.currentOpm=0,this.onMoneyChange=null,this.mailboxContainer=c("mailboxContainer"),this.mailSelectAllActionBtn=c("mailSelectAllActionBtn"),this.mailSelectBtn=c("mailSelectBtn"),this.mailReplyBtn=c("mailReplyBtn"),this.mailSyncBtn=c("mailSyncBtn")}init(){this.renderMailbox(),this.updateMailUI(),this.mailSelectAllActionBtn.addEventListener("click",()=>this.handleSelectAllAction()),this.mailReplyBtn.addEventListener("click",()=>this.handleReplyAll())}update(t){}getMetrics(){const t=s.MAIL_HANDLED_MULTIPLIER*Math.pow(2,this.doubleMailboxCount),e=Date.now(),o=(e-this.lastOpmUpdate)/6e4;if(o>=.1){const n=this.totalOverhead-this.lastPrimaryValue;this.currentOpm=n/o,this.lastOpmUpdate=e,this.lastPrimaryValue=this.totalOverhead}return{name:"Mailbox",primaryValue:this.totalOverhead,label:`Mails handled: ${this.mailHandled}`,opm:this.currentOpm,multiplier:t}}getMailCheckboxes(){return this.mailboxContainer.querySelectorAll(".mail-checkbox")}updateMailUI(){const t=this.getMailCheckboxes(),e=Array.from(t).filter(r=>r.checked).length,n=(this.increaseMailboxPurchased?s.MAIL_TOTAL_UPGRADED:s.MAIL_TOTAL)-e;this.mailSyncing?(this.mailSelectAllActionBtn.style.display="none",this.mailSelectBtn.style.display="none",this.mailReplyBtn.style.display="none",this.mailSyncBtn.style.display="block"):n===0?(this.mailSelectAllActionBtn.style.display="none",this.mailSelectBtn.style.display="none",this.mailReplyBtn.style.display="block",this.mailSyncBtn.style.display="none"):(this.mailSelectBtn.textContent=`Select ${n}...`,this.mailSelectBtn.disabled=!0,this.mailSelectBtn.style.display="block",this.mailSelectAllActionBtn.style.display="none",this.mailReplyBtn.style.display="none",this.mailSyncBtn.style.display="none")}handleMailCheckboxChange(){this.updateMailUI()}handleSelectAllAction(){this.getMailCheckboxes().forEach(e=>e.checked=!0),this.updateMailUI()}handleReplyAll(){this.mailHandled+=1;const t=s.MAIL_HANDLED_MULTIPLIER*Math.pow(2,this.doubleMailboxCount);this.totalOverhead+=t;const e=Math.floor(t/Math.log10(this.totalOverhead+10));if(this.onMoneyChange&&e>0&&this.onMoneyChange(e),this.instantSyncPurchased){this.resetMailbox();return}this.mailSyncing=!0,this.mailboxContainer.querySelectorAll(".mail-item").forEach(u=>u.style.display="none");let n=s.MAIL_SYNC_SECONDS;this.mailSyncBtn.textContent=`Outlook synchronizing. ${n}...`,this.mailSyncBtn.style.display="block",this.mailReplyBtn.style.display="none",this.mailSelectBtn.style.display="none";const r=setInterval(()=>{n--,this.mailSyncBtn.textContent=`Outlook synchronizing. ${n}...`,n<=0&&(clearInterval(r),this.resetMailbox())},1e3)}resetMailbox(){this.mailSyncing=!1,this.renderMailbox(),this.updateMailUI(),this.autoMailPurchased&&!this.autoMailRunning&&setTimeout(()=>this.autoCheckMails(),500)}async autoCheckMails(){if(this.mailSyncing||this.autoMailRunning)return;this.autoMailRunning=!0;const t=this.getMailCheckboxes(),e=this.fasterAutoMailPurchased?s.AUTO_MAIL_CHECK_DELAY_MS/2:s.AUTO_MAIL_CHECK_DELAY_MS;for(let o=0;o<t.length;o++)await new Promise(n=>setTimeout(n,e)),t[o].checked=!0,this.updateMailUI();await new Promise(o=>setTimeout(o,e)),this.autoMailRunning=!1,this.handleReplyAll()}getRandomMails(t){return[...v].sort(()=>Math.random()-.5).slice(0,t)}renderMailbox(){this.mailboxContainer.innerHTML="";const t=this.increaseMailboxPurchased?s.MAIL_TOTAL_UPGRADED:s.MAIL_TOTAL;this.getRandomMails(t).forEach(o=>{const n=document.createElement("div");n.className="mail-item";const r=document.createElement("label"),u=document.createElement("input");u.type="checkbox",u.className="mail-checkbox",u.addEventListener("change",()=>this.handleMailCheckboxChange());const p=document.createElement("span");p.className="mail-subject",p.textContent=o.subject;const h=document.createElement("span");h.className="mail-person",h.textContent=o.sender,r.appendChild(u),r.appendChild(p),r.appendChild(h),n.appendChild(r),this.mailboxContainer.appendChild(n)})}purchaseAutoMail(t){return t>=s.UPGRADE_AUTO_MAIL_COST&&!this.autoMailPurchased?(this.autoMailPurchased=!0,this.onMoneyChange&&this.onMoneyChange(-100),!this.mailSyncing&&!this.autoMailRunning&&this.autoCheckMails(),!0):!1}purchaseInstantSync(t){return t>=s.UPGRADE_INSTANT_SYNC_COST&&!this.instantSyncPurchased?(this.instantSyncPurchased=!0,this.onMoneyChange&&this.onMoneyChange(-200),!0):!1}purchaseFasterAutoMail(t){return t>=s.UPGRADE_FASTER_AUTO_MAIL_COST&&!this.fasterAutoMailPurchased?(this.fasterAutoMailPurchased=!0,this.onMoneyChange&&this.onMoneyChange(-150),!0):!1}purchaseDoubleMailbox(t){const e=s.UPGRADE_DOUBLE_MAILBOX_BASE_COST*Math.pow(2,this.doubleMailboxCount);return t>=e?(this.doubleMailboxCount++,this.onMoneyChange&&this.onMoneyChange(-e),!0):!1}purchaseIncreaseMailbox(t){return t>=s.UPGRADE_INCREASE_MAILBOX_COST&&!this.increaseMailboxPurchased?(this.increaseMailboxPurchased=!0,this.onMoneyChange&&this.onMoneyChange(-1e3),this.renderMailbox(),this.updateMailUI(),!0):!1}getMailHandled(){return this.mailHandled}isAutoMailPurchased(){return this.autoMailPurchased}isInstantSyncPurchased(){return this.instantSyncPurchased}isFasterAutoMailPurchased(){return this.fasterAutoMailPurchased}getDoubleMailboxCount(){return this.doubleMailboxCount}getDoubleMailboxCost(){return s.UPGRADE_DOUBLE_MAILBOX_BASE_COST*Math.pow(2,this.doubleMailboxCount)}isIncreaseMailboxPurchased(){return this.increaseMailboxPurchased}setOnMoneyChange(t){this.onMoneyChange=t}addOverhead(t){this.totalOverhead+=t}}const L=[{title:"Best Practices Framework for Best Practices"},{title:"Strategic Synergy Optimization Protocol"},{title:"Cross-Functional Value Alignment Matrix"},{title:"Agile Transformation Enablement Guidelines"},{title:"Holistic Stakeholder Engagement Framework"},{title:"Enterprise-Wide Scalability Roadmap"},{title:"Dynamic Resource Allocation Methodology"},{title:"Operational Excellence Acceleration Plan"},{title:"Unified Governance and Compliance Charter"},{title:"Innovation-Driven Growth Strategy Document"}],R=["CEO","CFO","CTO","Legal","HR","Marketing","Sales","External Auditor","Board Member","Compliance Officer","Regional Manager","Department Head","Project Lead"];class N extends I{constructor(){super("overheadManager",!1),this.isStarted=!1,this.currentDocument=null,this.documentInProgress=!1,this.documentsCompleted=0,this.permanentStakeholders=["CEO","CFO","Legal"],this.commOfficerCount=0,this.documentSpeedMultiplier=1,this.doubleCorporationCount=3,this.totalOverhead=0,this.lastOpmUpdate=Date.now(),this.lastPrimaryValue=0,this.currentOpm=0,this.onMoneyChange=null,this.documentTitle=c("documentTitle"),this.signatureProgress=c("signatureProgress"),this.documentInfo=c("documentInfo"),this.scopeCreepValue=c("scopeCreepValue"),this.scopeCreepBar=c("scopeCreepBar"),this.hoursWasted=c("hoursWasted"),this.startCorporationBtn=c("startCorporationBtn"),this.documentStatus=c("documentStatus")}init(){this.startCorporationBtn.addEventListener("click",()=>this.startMinigame())}startMinigame(){if(this.isStarted)return;this.isStarted=!0,this.startCorporationBtn.style.display="none",this.documentStatus.style.display="block";const t=document.getElementById("upgradeStakeholderRow"),e=document.getElementById("upgradeDoubleCorporationRow"),o=document.getElementById("upgradeCommOfficerRow");t&&(t.style.display="table-row"),e&&(e.style.display="table-row"),o&&(o.style.display="table-row"),this.currentDocument=this.createNewDocument(),this.documentInProgress=!0,this.updateDocumentUI(),this.processDocument()}update(t){}getMetrics(){const t=Math.pow(2,this.doubleCorporationCount),e=Date.now(),o=(e-this.lastOpmUpdate)/6e4;if(o>=.1){const n=this.totalOverhead-this.lastPrimaryValue;this.currentOpm=n/o,this.lastOpmUpdate=e,this.lastPrimaryValue=this.totalOverhead}return{name:"Corporation",primaryValue:this.totalOverhead,label:`Documents completed: ${this.documentsCompleted}`,opm:this.currentOpm,multiplier:t}}getRandomPolicy(){const t=Math.floor(Math.random()*L.length);return L[t].title}createNewDocument(){return{title:this.getRandomPolicy(),version:"v1.2.3",signatories:[...this.permanentStakeholders],currentSignatureIndex:0,totalRevisions:0,scopeCreep:0}}updateDocumentUI(){if(!this.currentDocument)return;const t=this.currentDocument;this.documentTitle.textContent=`${t.title} ${t.version}`,this.signatureProgress.innerHTML=t.signatories.map((e,o)=>{const n=o<t.currentSignatureIndex,r=o===t.currentSignatureIndex;return`<span style="${n?"color: green;":r?"color: orange;":"color: gray;"}">${n?"‚óè":"‚óã"} ${e}</span>`}).join(" ‚Üí "),this.documentInfo.textContent=`Signatures: ${t.currentSignatureIndex}/${t.signatories.length} | Revisions: ${t.totalRevisions}`,this.scopeCreepValue.textContent=Math.floor(t.scopeCreep).toString(),this.scopeCreepBar.style.width=`${t.scopeCreep}%`}async processDocument(){if(!this.currentDocument||!this.documentInProgress)return;const t=this.currentDocument,e=s.DOCUMENT_SIGNATURE_DELAY_MS/this.documentSpeedMultiplier;for(;t.currentSignatureIndex<t.signatories.length;)await new Promise(n=>setTimeout(n,e)),t.currentSignatureIndex++,this.updateDocumentUI();t.scopeCreep=Math.min(t.scopeCreep+s.SCOPE_CREEP_INCREMENT,s.SCOPE_CREEP_MAX),t.totalRevisions++,t.currentSignatureIndex=0;const o=t.version.match(/v(\d+)\.(\d+)\.(\d+)/);if(o){const n=parseInt(o[3])+1;t.version=`v${o[1]}.${o[2]}.${n}`}if(this.updateDocumentUI(),t.scopeCreep>=s.SCOPE_CREEP_MAX){const n=t.signatories.length*100,r=Math.pow(2,this.doubleCorporationCount),u=n*r;this.hoursWasted.textContent=`‚ö†Ô∏è ${u} hours wasted! ‚ö†Ô∏è`,this.hoursWasted.style.display="block",this.hoursWasted.style.animation="blink 1s infinite",this.totalOverhead+=u;const p=Math.floor(u/Math.log10(this.totalOverhead+10));this.onMoneyChange&&p>0&&this.onMoneyChange(p),this.documentsCompleted++,this.currentDocument=this.createNewDocument(),this.documentInProgress=!0,this.updateDocumentUI(),setTimeout(()=>{this.hoursWasted.style.display="none"},2e3),this.processDocument()}else this.processDocument()}addStakeholder(){if(!this.currentDocument||!this.documentInProgress)return;const t=this.currentDocument,e=R.filter(o=>!this.permanentStakeholders.includes(o));if(e.length>0){const o=e[Math.floor(Math.random()*e.length)];this.permanentStakeholders.push(o),t.signatories.push(o),t.scopeCreep=Math.min(t.scopeCreep+10,s.SCOPE_CREEP_MAX),this.onMoneyChange&&this.onMoneyChange(-5e3),this.updateDocumentUI()}}purchaseStakeholder(t){if(!this.isStarted||!this.currentDocument||!this.documentInProgress)return!1;if(t>=s.ADD_STAKEHOLDER_COST){const e=this.currentDocument,o=R.filter(n=>!this.permanentStakeholders.includes(n));if(o.length>0){const n=o[Math.floor(Math.random()*o.length)];return this.permanentStakeholders.push(n),e.signatories.push(n),e.scopeCreep=Math.min(e.scopeCreep+10,s.SCOPE_CREEP_MAX),this.onMoneyChange&&this.onMoneyChange(-5e3),this.updateDocumentUI(),!0}}return!1}purchaseDoubleCorporation(t){const e=s.UPGRADE_DOUBLE_CORPORATION_BASE_COST*Math.pow(2,this.doubleCorporationCount);return t>=e?(this.doubleCorporationCount++,this.onMoneyChange&&this.onMoneyChange(-e),!0):!1}purchaseCommOfficer(t){const e=s.UPGRADE_COMM_OFFICER_BASE_COST*Math.pow(2,this.commOfficerCount);return t>=e?(this.commOfficerCount++,this.documentSpeedMultiplier*=2,this.onMoneyChange&&this.onMoneyChange(-e),!0):!1}getCommOfficerCost(){return s.UPGRADE_COMM_OFFICER_BASE_COST*Math.pow(2,this.commOfficerCount)}getDoubleCorporationCost(){return s.UPGRADE_DOUBLE_CORPORATION_BASE_COST*Math.pow(2,this.doubleCorporationCount)}getDoubleCorporationCount(){return this.doubleCorporationCount}getCommOfficerCount(){return this.commOfficerCount}getDocumentSpeedMultiplier(){return this.documentSpeedMultiplier}setOnMoneyChange(t){this.onMoneyChange=t}}class $ extends I{constructor(){if(super("world",!1),this.isActive=!1,this.mailsPerSecond=0,this.avgContactsPerPerson=1,this.totalEmailsSent=0,this.worldMailCount=0,this.worldContactCount=0,this.lastOpmUpdate=Date.now(),this.lastPrimaryValue=0,this.currentOpm=0,this.onMoneyChange=null,this.animationFrame=null,this.dots=[],this.paths=[],this.lastUpdateTime=0,this.mailsEl=document.getElementById("worldMails"),this.contactsEl=document.getElementById("worldContacts"),this.totalEl=document.getElementById("worldTotal"),this.treeEl=document.getElementById("worldTree"),this.startBtn=document.getElementById("worldBtn"),this.worldContent=document.getElementById("worldContent"),!this.mailsEl||!this.contactsEl||!this.totalEl||!this.treeEl||!this.startBtn||!this.worldContent)throw new Error("Missing world module elements")}init(){this.startBtn.addEventListener("click",()=>this.startModule()),this.updateDisplay()}update(t){}getMetrics(){const t=Math.floor(this.totalEmailsSent*s.TOTAL_EMAILS_MULTIPLIER),e=Date.now(),o=(e-this.lastOpmUpdate)/6e4;if(o>=.1){const n=t-this.lastPrimaryValue;this.currentOpm=n/o,this.lastOpmUpdate=e,this.lastPrimaryValue=t}return{name:"World",primaryValue:t,label:`Total emails sent: ${Math.floor(this.totalEmailsSent).toLocaleString()}`,opm:this.currentOpm,multiplier:s.TOTAL_EMAILS_MULTIPLIER}}startModule(){if(this.isActive)return;this.isActive=!0,this.startBtn.style.display="none",this.worldContent.style.display="block";const t=document.getElementById("upgradeWorldMailRow"),e=document.getElementById("upgradeWorldContactRow");t&&(t.style.display="table-row"),e&&(e.style.display="table-row"),this.animate()}purchaseWorldMail(t){const e=this.getWorldMailCost();return t>=e?(this.worldMailCount++,this.mailsPerSecond++,this.onMoneyChange&&this.onMoneyChange(-e),this.updateDisplay(),!0):!1}purchaseWorldContact(t){const e=this.getWorldContactCost();return t>=e?(this.worldContactCount++,this.avgContactsPerPerson++,this.onMoneyChange&&this.onMoneyChange(-e),this.updateDisplay(),!0):!1}getWorldMailCost(){return s.UPGRADE_WORLD_MAIL_BASE_COST*Math.pow(2,this.worldMailCount)}getWorldContactCost(){return s.UPGRADE_WORLD_CONTACT_BASE_COST*Math.pow(2,this.worldContactCount)}getWorldMailCount(){return this.worldMailCount}getWorldContactCount(){return this.worldContactCount}setOnMoneyChange(t){this.onMoneyChange=t}updateDisplay(){this.mailsEl.textContent=this.mailsPerSecond.toString(),this.contactsEl.textContent=this.avgContactsPerPerson.toString(),this.totalEl.textContent=Math.floor(this.totalEmailsSent).toLocaleString(),this.mailsEl.style.animation="none",this.contactsEl.style.animation="none",this.totalEl.style.animation="none",setTimeout(()=>{this.mailsEl.style.animation="pulse 0.3s ease",this.contactsEl.style.animation="pulse 0.3s ease",this.totalEl.style.animation="pulse 0.3s ease"},10),this.renderTree()}renderTree(){const t=this.treeEl.offsetWidth||400,e=250;let o=this.treeEl.querySelector("svg");o||(o=document.createElementNS("http://www.w3.org/2000/svg","svg"),o.style.width="100%",o.style.height="250px",o.style.display="block",this.treeEl.appendChild(o)),o.setAttribute("viewBox",`0 0 ${t} ${e}`),o.setAttribute("preserveAspectRatio","xMidYMid meet");const n=Array.from(o.querySelectorAll(".mail-dot"));o.innerHTML="",n.forEach(h=>o.appendChild(h)),this.paths=[];const r=t/2,u=30,p=Math.max(this.avgContactsPerPerson,1);this.drawBranch(o,r,u,0,p,t,e)}drawBranch(t,e,o,n,r,u,p){const h=document.createElementNS("http://www.w3.org/2000/svg","circle");if(h.setAttribute("cx",e.toString()),h.setAttribute("cy",o.toString()),h.setAttribute("r",n===0?"6":"4"),h.setAttribute("fill",`hsl(${n*80}, 70%, 60%)`),h.setAttribute("data-depth",n.toString()),t.appendChild(h),n>=2)return;const g=o+100,d=n===0?10:3,m=Math.min(r,d),f=Math.max(0,r-d),b=Math.min(u/(m+1),80);for(let M=0;M<m;M++){const T=(M-(m-1)/2)*b,A=e+T,B=Math.max(20,Math.min(u-20,A)),O=document.createElementNS("http://www.w3.org/2000/svg","line");O.setAttribute("x1",e.toString()),O.setAttribute("y1",o.toString()),O.setAttribute("x2",B.toString()),O.setAttribute("y2",g.toString()),O.setAttribute("stroke","#4ecdc4"),O.setAttribute("stroke-opacity","0.6"),O.setAttribute("stroke-width","1"),t.appendChild(O),this.paths.push({x1:e,y1:o,x2:B,y2:g,depth:n}),this.drawBranch(t,B,g,n+1,r,u,p)}if(f>0){const M=e+(m-1)/2*b,T=Math.min(M+30,u-40),A=document.createElementNS("http://www.w3.org/2000/svg","text");A.setAttribute("x",T.toString()),A.setAttribute("y",(g+4).toString()),A.setAttribute("text-anchor","middle"),A.setAttribute("fill","#ff9800"),A.setAttribute("font-size","11"),A.setAttribute("font-weight","bold"),A.textContent=`+${f}`,t.appendChild(A)}}animate(){if(!this.isActive)return;const t=performance.now(),e=this.lastUpdateTime?(t-this.lastUpdateTime)/1e3:0;this.lastUpdateTime=t;const o=Math.max(this.avgContactsPerPerson,1),n=o+o*o;e>0&&e<1&&(this.totalEmailsSent+=this.mailsPerSecond*n*e,this.totalEl.textContent=Math.floor(this.totalEmailsSent).toLocaleString());const r=.008,p=Math.min(.1+this.mailsPerSecond*.1,5)*.015;this.paths.length>0&&Math.random()<p&&this.paths.map((d,m)=>({path:d,idx:m})).filter(({path:d})=>d.depth===0).forEach(({idx:d})=>{this.dots.push({progress:0,pathIndex:d,hasSpawnedChildren:!1})});const h=[];this.dots=this.dots.filter(g=>{if(g.progress+=r,g.progress>=.5&&!g.hasSpawnedChildren){g.hasSpawnedChildren=!0;const d=this.paths[g.pathIndex];d&&this.paths.forEach((m,f)=>{const b=Math.abs(m.x1-d.x2),M=Math.abs(m.y1-d.y2);b<5&&M<5&&f!==g.pathIndex&&h.push({progress:0,pathIndex:f,hasSpawnedChildren:!1})})}return g.progress<1}),this.dots.push(...h);const _=this.treeEl.querySelector("svg");_&&(_.querySelectorAll(".mail-dot").forEach(d=>d.remove()),this.dots.forEach(d=>{if(d.pathIndex<this.paths.length){const m=this.paths[d.pathIndex],f=m.x1+(m.x2-m.x1)*d.progress,b=m.y1+(m.y2-m.y1)*d.progress,M=document.createElementNS("http://www.w3.org/2000/svg","circle");M.classList.add("mail-dot"),M.setAttribute("cx",f.toString()),M.setAttribute("cy",b.toString()),M.setAttribute("r","3"),M.setAttribute("fill","#ff6b6b"),_.appendChild(M)}})),this.animationFrame=requestAnimationFrame(()=>this.animate())}isRunning(){return this.isActive}getTotalEmailsSent(){return this.totalEmailsSent}}class G{constructor(){this.state={counters:[],outputValue:0,money:s.STARTING_MONEY,lastChartTotal:0,stepMultiplier:1,mailHandled:0,mailSyncing:!1,autoMailPurchased:!1,autoMailRunning:!1,instantSyncPurchased:!1,selectAllPurchased:!1,currentDocument:null,documentInProgress:!1,documentsCompleted:0,permanentStakeholders:["CEO","CFO","Legal"],commOfficerCount:0,documentSpeedMultiplier:1,hoursWastedTotal:0,module2Unlocked:!1,module3Unlocked:!1,winModuleShown:!1}}getMoney(){return this.state.money}getOutputValue(){return this.state.outputValue}getStepMultiplier(){return this.state.stepMultiplier}getCounters(){return this.state.counters}isModule2Unlocked(){return this.state.module2Unlocked}isModule3Unlocked(){return this.state.module3Unlocked}isWinModuleShown(){return this.state.winModuleShown}setOutputValue(t){this.state.outputValue=t}addMoney(t){this.state.money+=t}spendMoney(t){return this.state.money>=t?(this.state.money-=t,!0):!1}setModule2Unlocked(t){this.state.module2Unlocked=t}setModule3Unlocked(t){this.state.module3Unlocked=t}setWinModuleShown(t){this.state.winModuleShown=t}addCounter(t){this.state.counters.push(t)}doubleStepMultiplier(){this.state.stepMultiplier*=2}}const l=new G,a={totalEl:c("total"),progressBar:c("progressBar"),progressText:c("progressText"),upgradeAutoMailBtn:c("upgradeAutoMailBtn"),upgradeFasterAutoMailBtn:c("upgradeFasterAutoMailBtn"),upgradeInstantSyncBtn:c("upgradeInstantSyncBtn"),upgradeIncreaseMailboxBtn:c("upgradeIncreaseMailboxBtn"),upgradeDoubleMailboxBtn:c("upgradeDoubleMailboxBtn"),upgradeStakeholderBtn:c("upgradeStakeholderBtn"),upgradeDoubleCorporationBtn:c("upgradeDoubleCorporationBtn"),upgradeCommOfficerBtn:c("upgradeCommOfficerBtn"),upgradeWorldMailBtn:c("upgradeWorldMailBtn"),upgradeWorldContactBtn:c("upgradeWorldContactBtn"),ctx:c("counterChart"),moduleStatsBody:c("moduleStatsBody")},y=new H,C=new N,E=new $,W=new k(a.ctx),D=new w;function F(i){if(!l.isModule2Unlocked()&&i>=s.MODULE_2_THRESHOLD&&(l.setModule2Unlocked(!0),C.unlock()),!l.isModule3Unlocked()&&i>=s.MODULE_3_THRESHOLD&&(l.setModule3Unlocked(!0),E.unlock()),!l.isWinModuleShown()&&i>=s.WIN_THRESHOLD){l.setWinModuleShown(!0);const t=document.getElementById("module-win");if(t){t.classList.remove("locked"),console.log("You win!");const e=document.getElementById("mailbox"),o=document.getElementById("overheadManager"),n=document.getElementById("world"),r=document.getElementById("counterModule"),u=document.getElementById("upgrades"),p=document.getElementById("progressModule"),h=document.querySelector(".top-bar");e&&(e.style.display="none"),o&&(o.style.display="none"),n&&(n.style.display="none"),r&&(r.style.display="none"),u&&(u.style.display="none"),p&&(p.style.display="none"),h&&(h.style.display="none")}}}function V(i){let t=0,e="";if(i<s.MODULE_2_THRESHOLD)t=i/s.MODULE_2_THRESHOLD*100,e=`Level 1: ${Math.floor(i).toLocaleString()} / 200k`;else if(i<s.MODULE_3_THRESHOLD){const o=s.MODULE_3_THRESHOLD-s.MODULE_2_THRESHOLD;t=(i-s.MODULE_2_THRESHOLD)/o*100,e=`Level 2: ${Math.floor(i).toLocaleString()} / 2M`}else{const o=s.WIN_THRESHOLD-s.MODULE_3_THRESHOLD;t=(i-s.MODULE_3_THRESHOLD)/o*100,e=`Level 3: ${Math.floor(i).toLocaleString()} / 100B`}t=P(t,0,100),a.progressBar.style.width=t+"%",a.progressText.textContent=`${t.toFixed(2)}% - ${e}`}function X(){const i=y.getMetrics(),t=C.getMetrics(),e=E.getMetrics();return i.primaryValue+t.primaryValue+e.primaryValue}function Y(){const i=y.getMetrics(),t=C.getMetrics(),e=E.getMetrics(),o=[i,t,e];a.moduleStatsBody.innerHTML=o.map(n=>{const r=n.opm!==void 0?Math.floor(n.opm).toLocaleString():"0",u=n.multiplier!==void 0?`${n.multiplier}x`:"1x",p=Math.floor(n.primaryValue).toLocaleString();return`
      <tr style="border-bottom: 1px solid #444;">
        <td style="padding: 8px;">${n.name}</td>
        <td style="text-align: right; padding: 8px;">${p}</td>
        <td style="text-align: right; padding: 8px;">${r}</td>
        <td style="text-align: right; padding: 8px;">${u}</td>
      </tr>
    `}).join("")}function S(){const i=X();if(l.setOutputValue(i),a.totalEl.textContent=`Total overhead: ${Math.floor(i)}h | Money: $${Math.floor(l.getMoney())}`,V(i),Y(),F(i),!l.isWinModuleShown()){const f=document.getElementById("upgrades"),b=document.getElementById("progressModule"),M=document.getElementById("counterModule");f&&i>=s.UPGRADES_MODULE_THRESHOLD&&(f.style.display=""),b&&i>=s.PROGRESS_MODULE_THRESHOLD&&(b.style.display=""),M&&i>=s.COUNTER_MODULE_THRESHOLD&&(M.style.display="")}const t=document.getElementById("upgradeAutoMailRow"),e=document.getElementById("upgradeFasterAutoMailRow"),o=document.getElementById("upgradeInstantSyncRow"),n=document.getElementById("upgradeDoubleMailboxRow"),r=document.getElementById("upgradeIncreaseMailboxRow");t&&(t.style.display=i>=s.UPGRADE_AUTO_MAIL_THRESHOLD?"":"none"),e&&(e.style.display=i>=s.UPGRADE_FASTER_AUTO_MAIL_THRESHOLD?"":"none"),o&&(o.style.display=i>=s.UPGRADE_INSTANT_SYNC_THRESHOLD?"":"none"),n&&(n.style.display=i>=s.UPGRADE_DOUBLE_MAILBOX_THRESHOLD?"":"none"),r&&(r.style.display=i>=s.UPGRADE_INCREASE_MAILBOX_THRESHOLD?"":"none"),y.isAutoMailPurchased()?(a.upgradeAutoMailBtn.textContent="Intern: Active",a.upgradeAutoMailBtn.disabled=!0):(a.upgradeAutoMailBtn.textContent=`Intern ad ($${s.UPGRADE_AUTO_MAIL_COST})`,a.upgradeAutoMailBtn.disabled=l.getMoney()<s.UPGRADE_AUTO_MAIL_COST),y.isFasterAutoMailPurchased()?(a.upgradeFasterAutoMailBtn.textContent="No breaks: Active",a.upgradeFasterAutoMailBtn.disabled=!0):(a.upgradeFasterAutoMailBtn.textContent=`No breaks for intern ($${s.UPGRADE_FASTER_AUTO_MAIL_COST})`,a.upgradeFasterAutoMailBtn.disabled=l.getMoney()<s.UPGRADE_FASTER_AUTO_MAIL_COST),y.isInstantSyncPurchased()?(a.upgradeInstantSyncBtn.textContent="Instant Sync: Active",a.upgradeInstantSyncBtn.disabled=!0):(a.upgradeInstantSyncBtn.textContent=`Instant Sync ($${s.UPGRADE_INSTANT_SYNC_COST})`,a.upgradeInstantSyncBtn.disabled=l.getMoney()<s.UPGRADE_INSTANT_SYNC_COST),y.isIncreaseMailboxPurchased()?(a.upgradeIncreaseMailboxBtn.textContent="Mailbox Size: 10 Emails",a.upgradeIncreaseMailboxBtn.disabled=!0):(a.upgradeIncreaseMailboxBtn.textContent=`Increase Mailbox to 10 Emails ($${s.UPGRADE_INCREASE_MAILBOX_COST})`,a.upgradeIncreaseMailboxBtn.disabled=l.getMoney()<s.UPGRADE_INCREASE_MAILBOX_COST);const u=y.getDoubleMailboxCost(),p=y.getDoubleMailboxCount();a.upgradeDoubleMailboxBtn.textContent=`Double Mailbox Output ($${u}) [${p}x]`,a.upgradeDoubleMailboxBtn.disabled=l.getMoney()<u,a.upgradeStakeholderBtn.textContent=`Add Stakeholder ($${s.ADD_STAKEHOLDER_COST})`,a.upgradeStakeholderBtn.disabled=l.getMoney()<s.ADD_STAKEHOLDER_COST;const h=C.getDoubleCorporationCost(),_=C.getDoubleCorporationCount();a.upgradeDoubleCorporationBtn.textContent=`Double Corporation Output ($${h}) [${_}x]`,a.upgradeDoubleCorporationBtn.disabled=l.getMoney()<h;const g=C.getCommOfficerCost();a.upgradeCommOfficerBtn.textContent=`Hire Comm Officer ($${g}) [${C.getCommOfficerCount()}x, ${C.getDocumentSpeedMultiplier()}x speed]`,a.upgradeCommOfficerBtn.disabled=l.getMoney()<g;const d=E.getWorldMailCost(),m=E.getWorldContactCost();return a.upgradeWorldMailBtn.textContent=`+1 Mail/sec ($${d.toLocaleString()}) [${E.getWorldMailCount()}]`,a.upgradeWorldMailBtn.disabled=l.getMoney()<d,a.upgradeWorldContactBtn.textContent=`+1 Contact/person ($${m.toLocaleString()}) [${E.getWorldContactCount()}]`,a.upgradeWorldContactBtn.disabled=l.getMoney()<m,i}function j(){y.purchaseAutoMail(l.getMoney())?S():alert("Not enough money!")}function q(){y.purchaseFasterAutoMail(l.getMoney())?S():alert("Not enough money!")}function K(){y.purchaseInstantSync(l.getMoney())?S():alert("Not enough money!")}function z(){y.purchaseIncreaseMailbox(l.getMoney())?S():alert("Not enough money!")}function J(){y.purchaseDoubleMailbox(l.getMoney())?S():alert("Not enough money!")}function Q(){C.purchaseStakeholder(l.getMoney())?S():alert("Not enough money!")}function Z(){C.purchaseDoubleCorporation(l.getMoney())?S():alert("Not enough money!")}function tt(){C.purchaseCommOfficer(l.getMoney())?S():alert("Not enough money!")}function et(){E.purchaseWorldMail(l.getMoney())?S():alert("Not enough money!")}function ot(){E.purchaseWorldContact(l.getMoney())?S():alert("Not enough money!")}D.onBoostMoney(()=>{l.addMoney(9999999999999),S()});D.onToggle(i=>{if(i){console.log("Debug commands available:"),console.log("- Click Module 2 header to unlock Corporation"),console.log("- Click Module 3 header to unlock World");const t=document.querySelector("#overheadManager h4");t&&t.addEventListener("click",()=>{D.unlockModule("overheadManager"),l.setModule2Unlocked(!0),C.unlock()});const e=document.querySelector("#world h4");e&&e.addEventListener("click",()=>{D.unlockModule("world"),l.setModule3Unlocked(!0),E.unlock()})}});const x=document.getElementById("addOverheadBtn");x&&x.addEventListener("click",()=>{y.addOverhead(2e10),S()});a.upgradeAutoMailBtn.addEventListener("click",j);a.upgradeFasterAutoMailBtn.addEventListener("click",q);a.upgradeInstantSyncBtn.addEventListener("click",K);a.upgradeIncreaseMailboxBtn.addEventListener("click",z);a.upgradeDoubleMailboxBtn.addEventListener("click",J);a.upgradeStakeholderBtn.addEventListener("click",Q);a.upgradeDoubleCorporationBtn.addEventListener("click",Z);a.upgradeCommOfficerBtn.addEventListener("click",tt);a.upgradeWorldMailBtn.addEventListener("click",et);a.upgradeWorldContactBtn.addEventListener("click",ot);y.setOnMoneyChange(i=>l.addMoney(i));C.setOnMoneyChange(i=>l.addMoney(i));E.setOnMoneyChange(i=>l.addMoney(i));function nt(){y.init(),C.init(),E.init(),setInterval(S,s.UI_UPDATE_MS),setInterval(()=>{const i=S();W.updateDelta(i)},s.CHART_INTERVAL_MS),console.log("Reply All - The Game started!"),console.log("Modules loaded: Mailbox, Corporation (locked), World (locked)")}nt();
